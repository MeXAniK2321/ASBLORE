item_abyss_horn = class({})
LinkLuaModifier("modifier_item_abyss_horn", "items/item_abyss_horn", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_hero_route", "items/item_abyss_horn", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_demon_route", "items/item_abyss_horn", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_hero_route_1", "items/item_abyss_horn", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_hero_route_2", "items/item_abyss_horn", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_hero_route_3", "items/item_abyss_horn", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_hero_route_4", "items/item_abyss_horn", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_hero_route_5", "items/item_abyss_horn", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_hero_route_6", "items/item_abyss_horn", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_hero_route_true", "items/item_abyss_horn", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_demon_route", "items/item_abyss_horn", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_demon_route_1", "items/item_abyss_horn", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_demon_route_2", "items/item_abyss_horn", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_demon_route_3", "items/item_abyss_horn", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_demon_route_4", "items/item_abyss_horn", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_demon_route_5", "items/item_abyss_horn", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_demon_route_6", "items/item_abyss_horn", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_demon_route_true", "items/item_abyss_horn", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_demon_route_control", "items/item_abyss_horn", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_demon_route_slow", "items/item_abyss_horn", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_samurai_bleed", "items/item_abyss_horn", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_samurai_block", "items/item_abyss_horn", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_samurai_block2", "items/item_abyss_horn", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_samurai_full_counter", "items/item_abyss_horn", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_samurai_route", "items/item_abyss_horn", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_samurai_route_1", "items/item_abyss_horn", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_samurai_route_2", "items/item_abyss_horn", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_samurai_route_3", "items/item_abyss_horn", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_samurai_route_4", "items/item_abyss_horn", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_samurai_route_5", "items/item_abyss_horn", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_samurai_route_6", "items/item_abyss_horn", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_samurai_route_true", "items/item_abyss_horn", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_samurai_slow", "items/item_abyss_horn", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_succubus_orgy", "items/item_angel_halo", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_abyss_choice", "items/item_abyss_horn", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_abyss_chosed", "items/item_abyss_horn", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_abyss_horn_cd", "items/item_abyss_horn", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_abyss_start", "items/item_abyss_horn", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_demon_route_alt", "items/item_abyss_horn", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_samurai_route_alt", "items/item_abyss_horn", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_hero_route_alt", "items/item_abyss_horn", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_halo_slow", "items/item_angel_halo", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_halo_attack", "items/item_angel_halo", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_halo_root", "items/item_angel_halo", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_lust_armor_invul", "items/item_angel_halo", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_angel_halo_stage_10_invul", "items/item_angel_halo", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_halo_spirits_stats_1", "items/item_abyss_horn", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_halo_spirits_stats_2", "items/item_abyss_horn", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_halo_spirits_stats_3", "items/item_abyss_horn", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_halo_spirits_stats_4", "items/item_abyss_horn", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_halo_fire", "items/item_abyss_horn", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_halo_earth", "items/item_abyss_horn", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_halo_water", "items/item_abyss_horn", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_halo_wind", "items/item_abyss_horn", LUA_MODIFIER_MOTION_NONE)





function item_abyss_horn:GetIntrinsicModifierName()
	return "modifier_item_abyss_horn"
end
function item_abyss_horn:GetBehavior()
	if self:GetCaster():HasModifier("modifier_abyss_start") then
	return DOTA_ABILITY_BEHAVIOR_UNIT_TARGET
		
	end
	return DOTA_ABILITY_BEHAVIOR_NO_TARGET
end
function item_abyss_horn:OnSpellStart()
	local caster = self:GetCaster()
	local duration = 60
	local target = self:GetCursorTarget()
	local player = self:GetCaster()
	local PID = player:GetPlayerOwnerID()
    local id32 = PlayerResource:IsFakeClient(PID) and PID * 32 or PlayerResource:GetSteamAccountID(PID)
	local hero = PlayerResource:GetSelectedHeroEntity(PID)
	



if caster:HasModifier("modifier_abyss_start") then
if  caster:HasModifier("modifier_hero_route_1") then
self:GetCaster():PerformAttack (
		target,
		true,
		true,
		true,
		false,
		false,
		false,
		true
	)
	EmitSoundOn("halo.attack", caster)
	self:PlayEffects(target)
elseif  caster:HasModifier("modifier_hero_route_2") then
self:GetCaster():PerformAttack (
		target,
		true,
		true,
		true,
		false,
		false,
		false,
		true
	)
	target:AddNewModifier(caster, self, "modifier_halo_slow", {duration = 2})
	EmitSoundOn("halo.water", caster)
	self:PlayEffects1(target)
elseif  caster:HasModifier("modifier_hero_route_3") then
local modifier = self:GetCaster():AddNewModifier(
		self:GetCaster(),
		self,
		"modifier_halo_attack",
		{}
	)
		self:GetCaster():PerformAttack (
		target,
		true,
		true,
		true,
		false,
		false,
		false,
		true
	)
	modifier:Destroy()
	EmitSoundOn("halo.crit", caster)
	self:PlayEffects2(target)
elseif  caster:HasModifier("modifier_hero_route_4") then
local hp = caster:GetHealth()
local max_hp = caster:GetMaxHealth()
local damage = (max_hp - hp) * 0.4
EmitSoundOn("halo.crit", caster)
	local damageTable = {
		attacker = caster,
		damage = damage,
		damage_type = DAMAGE_TYPE_PHYSICAL,
		ability = self,
		damage_flags = DOTA_DAMAGE_FLAG_NO_SPELL_AMPLIFICATION,
	}
	damageTable.victim = target
		ApplyDamage(damageTable)
self:PlayEffects3(target)
elseif  caster:HasModifier("modifier_hero_route_5") then
EmitSoundOn("halo.magic", caster)
	EmitSoundOn("halo.magic_exp", caster)
	target:AddNewModifier(caster, self, "modifier_stunned", {duration = 1.0})
	local delay = 1
	Timers:CreateTimer(delay,function()
	local damageTable = {
		attacker = caster,
		damage = 1000,
		damage_type = DAMAGE_TYPE_PURE,
		ability = self,
		damage_flags = DOTA_DAMAGE_FLAG_NO_SPELL_AMPLIFICATION,
	}
	damageTable.victim = target
		ApplyDamage(damageTable)
		end)
		self:PlayEffects5(target)
elseif  caster:HasModifier("modifier_hero_route_6") then
local hp = caster:GetHealth()
local max_hp = caster:GetMaxHealth()
local damage = (max_hp - hp)
EmitSoundOn("halo.crit", caster)
	local damageTable = {
		attacker = caster,
		damage = damage,
		damage_type = DAMAGE_TYPE_PHYSICAL,
		ability = self,
		damage_flags = DOTA_DAMAGE_FLAG_NO_SPELL_AMPLIFICATION,
	}
	damageTable.victim = target
		ApplyDamage(damageTable)
		self:PlayEffects4(target)

elseif caster:HasModifier("modifier_demon_route_1") then

target:AddNewModifier(caster, self, "modifier_halo_slow", {duration = 2})
	EmitSoundOn("halo.dark_1", caster)
	local damageTable = {
		attacker = caster,
		damage = 700,
		damage_type = DAMAGE_TYPE_PURE,
		ability = self,
		damage_flags = DOTA_DAMAGE_FLAG_NO_SPELL_AMPLIFICATION,
	}
	damageTable.victim = target
		ApplyDamage(damageTable)
		self:PlayEffects8(target)
		
		elseif caster:HasModifier("modifier_demon_route_2") then

target:AddNewModifier(caster, self, "modifier_halo_root", {duration = 1})
	EmitSoundOn("halo.dark_1", caster)
	local damageTable = {
		attacker = caster,
		damage = 800,
		damage_type = DAMAGE_TYPE_PURE,
		ability = self,
		damage_flags = DOTA_DAMAGE_FLAG_NO_SPELL_AMPLIFICATION,
	}
	damageTable.victim = target
		ApplyDamage(damageTable)
		self:PlayEffects10(target)
		
		elseif caster:HasModifier("modifier_demon_route_3") then

	EmitSoundOn("halo.dark_2", caster)
	local damageTable = {
		attacker = caster,
		damage = 1000,
		damage_type = DAMAGE_TYPE_PURE,
		ability = self,
		damage_flags = DOTA_DAMAGE_FLAG_NO_SPELL_AMPLIFICATION,
	}
	damageTable.victim = target
		ApplyDamage(damageTable)
		self:PlayEffects15(target)
		caster:Heal(800,caster)
		
				elseif caster:HasModifier("modifier_demon_route_4") then
target:AddNewModifier(caster, self, "modifier_halo_root", {duration = 1})
	EmitSoundOn("halo.dark_2", caster)
	local damageTable = {
		attacker = caster,
		damage = 1300,
		damage_type = DAMAGE_TYPE_PURE,
		ability = self,
		damage_flags = DOTA_DAMAGE_FLAG_NO_SPELL_AMPLIFICATION,
	}
	damageTable.victim = target
		ApplyDamage(damageTable)
		self:PlayEffects16(target)
		caster:Heal(1000,caster)
elseif caster:HasModifier("modifier_demon_route_6") then

	if target:GetUnitName()== "npc_dota_hero_axe" or  target:GetUnitName()== "npc_dota_hero_beastmaster" then
	EmitSoundOn("halo.succubus_gachi", caster)
	EmitSoundOn("halo.succubus_gachi_2", caster)
	else
	EmitSoundOn("halo.succubus", caster)
	EmitSoundOn("halo.succubus2", caster)
	end
	target:AddNewModifier(caster, self, "modifier_succubus_orgy", {duration = 4.5})

elseif caster:HasModifier("modifier_demon_route_5") then


	local sound_cast2 = "halo.slash"
	EmitSoundOn( sound_cast2, target )
	local player = self:GetCaster()
	local PID = player:GetPlayerOwnerID()
    local id32 = PlayerResource:IsFakeClient(PID) and PID * 32 or PlayerResource:GetSteamAccountID(PID)
	    local arcana = 137775440
		if id32 == arcana then
		self:PlayEffects12( target)
		else
	self:PlayEffects9( target)
	end
	target:AddNewModifier(caster, self, "modifier_stunned", {duration = 1})
	local damageTable = {
		attacker = caster,
		damage = 1300,
		damage_type = DAMAGE_TYPE_PURE,
		ability = self,
		damage_flags = DOTA_DAMAGE_FLAG_NO_SPELL_AMPLIFICATION,
	}
	damageTable.victim = target
		ApplyDamage(damageTable)
		
		
		elseif caster:HasModifier("modifier_samurai_route_1") then
		caster:AddNewModifier(caster, self, "modifier_samurai_block", {duration = 5})
	EmitSoundOn("halo.crit", caster)
	local damageTable = {
		attacker = caster,
		damage = 400,
		damage_type = DAMAGE_TYPE_PURE,
		ability = self,
		damage_flags = DOTA_DAMAGE_FLAG_NO_SPELL_AMPLIFICATION,
	}
	damageTable.victim = target
		ApplyDamage(damageTable)
		self:PlayEffects20(target)
		elseif caster:HasModifier("modifier_samurai_route_2") then
			caster:AddNewModifier(caster, self, "modifier_samurai_block", {duration = 5})
	EmitSoundOn("halo.crit", caster)
	local damageTable = {
		attacker = caster,
		damage = 600,
		damage_type = DAMAGE_TYPE_PURE,
		ability = self,
		damage_flags = DOTA_DAMAGE_FLAG_NO_SPELL_AMPLIFICATION,
	}
	damageTable.victim = target
		ApplyDamage(damageTable)
		self:PlayEffects21(target)
		elseif caster:HasModifier("modifier_samurai_route_3") then
			caster:AddNewModifier(caster, self, "modifier_samurai_block2", {duration = 5})
	EmitSoundOn("halo.crit", caster)
	local damageTable = {
		attacker = caster,
		damage = 800,
		damage_type = DAMAGE_TYPE_PURE,
		ability = self,
		damage_flags = DOTA_DAMAGE_FLAG_NO_SPELL_AMPLIFICATION,
	}
	damageTable.victim = target
		ApplyDamage(damageTable)
		self:PlayEffects22(target)
		elseif caster:HasModifier("modifier_samurai_route_4") then
			caster:AddNewModifier(caster, self, "modifier_samurai_block2", {duration = 5})
	EmitSoundOn("halo.crit", caster)
	local damageTable = {
		attacker = caster,
		damage = 1000,
		damage_type = DAMAGE_TYPE_PURE,
		ability = self,
		damage_flags = DOTA_DAMAGE_FLAG_NO_SPELL_AMPLIFICATION,
	}
	damageTable.victim = target
		ApplyDamage(damageTable)
		self:PlayEffects23(target)
		elseif caster:HasModifier("modifier_samurai_route_5") then
			caster:AddNewModifier(caster, self, "modifier_samurai_full_counter", {duration = 4})
	EmitSoundOn("horn.samurai_special", caster)
	local damageTable = {
		attacker = caster,
		damage = 1300,
		damage_type = DAMAGE_TYPE_PURE,
		ability = self,
		damage_flags = DOTA_DAMAGE_FLAG_NO_SPELL_AMPLIFICATION,
	}
	damageTable.victim = target
		ApplyDamage(damageTable)
		self:PlayEffects24(target)
		elseif caster:HasModifier("modifier_samurai_route_6") then
			target:AddNewModifier(caster, self, "modifier_samurai_bleed", {duration = 4})
	EmitSoundOn("horn.samurai_special", caster)
	local damageTable = {
		attacker = caster,
		damage = 1300,
		damage_type = DAMAGE_TYPE_PURE,
		ability = self,
		damage_flags = DOTA_DAMAGE_FLAG_NO_SPELL_AMPLIFICATION,
	}
	damageTable.victim = target
		ApplyDamage(damageTable)
		self:PlayEffects25(target)
end	
end
if caster:HasModifier("modifier_abyss_chosed") and not caster:HasModifier("modifier_abyss_start") then
local modifier_counter = caster:FindModifierByNameAndCaster("modifier_abyss_chosed",caster)
	self.current_counter = modifier_counter:GetStackCount()
if caster:HasModifier("modifier_hero_route") then
if  self.current_counter < 200 then

  caster:AddNewModifier(caster, self, "modifier_abyss_start", {duration = 30})
	caster:AddNewModifier(caster, self, "modifier_hero_route_1", {duration = 30})
	self:EndCooldown()
	
	elseif self.current_counter < 400 and self.current_counter > 200 or self.current_counter == 200 then
	 caster:AddNewModifier(caster, self, "modifier_abyss_start", {duration = 40})
	caster:AddNewModifier(caster, self, "modifier_hero_route_2", {duration = 40})
	self:EndCooldown()
	elseif self.current_counter < 600 and self.current_counter > 400 or self.current_counter == 400 then
	 caster:AddNewModifier(caster, self, "modifier_abyss_start", {duration = 45})
	caster:AddNewModifier(caster, self, "modifier_hero_route_3", {duration = 45})
	self:EndCooldown()
	
	elseif self.current_counter < 800 and self.current_counter > 600 or self.current_counter == 600 then
	
	 caster:AddNewModifier(caster, self, "modifier_abyss_start", {duration = 50})
	caster:AddNewModifier(caster, self, "modifier_hero_route_4", {duration = 50})
	self:EndCooldown()
	
	elseif self.current_counter == 800  then
	
	if caster:HasModifier("modifier_hero_route_true") then
		 caster:AddNewModifier(caster, self, "modifier_abyss_start", {duration = 60})
	caster:AddNewModifier(caster, self, "modifier_hero_route_5", {duration = 60})
	self:EndCooldown()
	else
	
	 caster:AddNewModifier(caster, self, "modifier_abyss_start", {duration = 60})
	caster:AddNewModifier(caster, self, "modifier_hero_route_6", {duration = 60})
	self:EndCooldown()
	end
	end
	
	
	
elseif caster:HasModifier("modifier_demon_route") then
if caster:HasModifier("modifier_abyss_start") then

else
if  self.current_counter < 200 then

  caster:AddNewModifier(caster, self, "modifier_abyss_start", {duration = 30})
	caster:AddNewModifier(caster, self, "modifier_demon_route_1", {duration = 30})
	self:EndCooldown()
	
	elseif self.current_counter < 400 and self.current_counter > 200 or self.current_counter == 200 then
	 caster:AddNewModifier(caster, self, "modifier_abyss_start", {duration = 40})
	caster:AddNewModifier(caster, self, "modifier_demon_route_2", {duration = 40})
	self:EndCooldown()
	elseif self.current_counter < 600 and self.current_counter > 400 or self.current_counter == 400 then
	 caster:AddNewModifier(caster, self, "modifier_abyss_start", {duration = 45})
	caster:AddNewModifier(caster, self, "modifier_demon_route_3", {duration = 45})
	self:EndCooldown()
	
	elseif self.current_counter < 800 and self.current_counter > 600 or self.current_counter == 600 then
	
	 caster:AddNewModifier(caster, self, "modifier_abyss_start", {duration = 50})
	caster:AddNewModifier(caster, self, "modifier_demon_route_4", {duration = 50})
	self:EndCooldown()
	
	elseif self.current_counter == 800  then
	
	if caster:HasModifier("modifier_demon_route_true") then
		 caster:AddNewModifier(caster, self, "modifier_abyss_start", {duration = 60})
	caster:AddNewModifier(caster, self, "modifier_demon_route_5", {duration = 60})
	caster:AddNewModifier(caster, self, "modifier_angel_halo_stage_10_invul", {duration = 3})
	self:EndCooldown()
	else
	
	 caster:AddNewModifier(caster, self, "modifier_abyss_start", {duration = 60})
	caster:AddNewModifier(caster, self, "modifier_demon_route_6", {duration = 60})
	caster:AddNewModifier(caster, self, "modifier_lust_armor_invul", {duration = 3})
	self:EndCooldown()
	end
	end
	end
	
elseif caster:HasModifier("modifier_samurai_route") then
if caster:HasModifier("modifier_abyss_start") then

else
if  self.current_counter < 200 then

  caster:AddNewModifier(caster, self, "modifier_abyss_start", {duration = 30})
	caster:AddNewModifier(caster, self, "modifier_samurai_route_1", {duration = 30})
	self:EndCooldown()
	
	elseif self.current_counter < 400 and self.current_counter > 200 or self.current_counter == 200 then
	 caster:AddNewModifier(caster, self, "modifier_abyss_start", {duration = 40})
	caster:AddNewModifier(caster, self, "modifier_samurai_route_2", {duration = 40})
	self:EndCooldown()
	elseif self.current_counter < 600 and self.current_counter > 400 or self.current_counter == 400 then
	 caster:AddNewModifier(caster, self, "modifier_abyss_start", {duration = 45})
	caster:AddNewModifier(caster, self, "modifier_samurai_route_3", {duration = 45})
	self:EndCooldown()
	
	elseif self.current_counter < 800 and self.current_counter > 600 or self.current_counter == 600 then
	
	 caster:AddNewModifier(caster, self, "modifier_abyss_start", {duration = 50})
	caster:AddNewModifier(caster, self, "modifier_samurai_route_4", {duration = 50})
	self:EndCooldown()
	
	elseif self.current_counter == 800  then
	
	if caster:HasModifier("modifier_samurai_route_true") then
		 caster:AddNewModifier(caster, self, "modifier_abyss_start", {duration = 60})
	caster:AddNewModifier(caster, self, "modifier_samurai_route_5", {duration = 60})
	self:EndCooldown()
	else
	
	 caster:AddNewModifier(caster, self, "modifier_abyss_start", {duration = 60})
	caster:AddNewModifier(caster, self, "modifier_samurai_route_6", {duration = 60})
	self:EndCooldown()
	end
	end
	end
	end
	end
	



if not caster:HasModifier("modifier_abyss_chosed") and not caster:HasModifier("modifier_abyss_choice")  then
caster:AddNewModifier(caster, self, "modifier_abyss_choice", {duration = 5})
self:EndCooldown()
EmitSoundOn("horn.choose_destiny", caster)
end

if caster:HasModifier("modifier_abyss_choice") then
self:EndCooldown()
local modifier = caster:FindModifierByNameAndCaster("modifier_abyss_choice",caster)
	if modifier == nil then return end
	local current = modifier:GetStackCount()
	if current == 3 then
	modifier:SetStackCount(1)
	else
	modifier:SetStackCount(current + 1)
	end
	end
	end
	
	
function item_abyss_horn:PlayEffects( target )
	-- Load effects
	local particle_cast = "particles/econ/items/wraith_king/wraith_king_arcana/wk_arc_weapon_blur_critical.vpcf"



	
	
	local effect_cast = ParticleManager:CreateParticle( particle_cast, PATTACH_ABSORIGIN_FOLLOW, target )
	ParticleManager:SetParticleControlEnt(
		effect_cast,
		0,
		target,
		PATTACH_POINT_FOLLOW,
		"attach_hitloc",
		target:GetOrigin(), -- unknown
		true -- unknown, true
	)
	ParticleManager:SetParticleControlForward( effect_cast, 1, (self:GetParent():GetOrigin()-target:GetOrigin()):Normalized() )
	ParticleManager:ReleaseParticleIndex( effect_cast )


end
function item_abyss_horn:PlayEffects1( target )
	-- Load effects
	local particle_cast = "particles/econ/items/monkey_king/arcana/water/monkey_king_spring_water_base.vpcf"



	
	
	local effect_cast = ParticleManager:CreateParticle( particle_cast, PATTACH_ABSORIGIN_FOLLOW, target )
	ParticleManager:SetParticleControlEnt(
		effect_cast,
		0,
		target,
		PATTACH_POINT_FOLLOW,
		"attach_hitloc",
		target:GetOrigin(), -- unknown
		true -- unknown, true
	)
	ParticleManager:SetParticleControlForward( effect_cast, 1, (self:GetParent():GetOrigin()-target:GetOrigin()):Normalized() )
	ParticleManager:ReleaseParticleIndex( effect_cast )


end
function item_abyss_horn:PlayEffects2( target )
	-- Load effects
	local particle_cast = "particles/halo_crit.vpcf"



	
	
	local effect_cast = ParticleManager:CreateParticle( particle_cast, PATTACH_ABSORIGIN_FOLLOW, target )
	ParticleManager:SetParticleControlEnt(
		effect_cast,
		0,
		target,
		PATTACH_POINT_FOLLOW,
		"attach_hitloc",
		target:GetOrigin(), -- unknown
		true -- unknown, true
	)
	ParticleManager:SetParticleControlForward( effect_cast, 1, (self:GetParent():GetOrigin()-target:GetOrigin()):Normalized() )
	ParticleManager:ReleaseParticleIndex( effect_cast )


end
function item_abyss_horn:PlayEffects3( target )
	-- Load effects
	local particle_cast = "particles/sf_fire_arcana_shadowraze_collumn1.vpcf"



	
	
	local effect_cast = ParticleManager:CreateParticle( particle_cast, PATTACH_ABSORIGIN_FOLLOW, target )
	ParticleManager:SetParticleControlEnt(
		effect_cast,
		0,
		target,
		PATTACH_POINT_FOLLOW,
		"attach_hitloc",
		target:GetOrigin(), -- unknown
		true -- unknown, true
	)
	ParticleManager:SetParticleControlForward( effect_cast, 1, (self:GetParent():GetOrigin()-target:GetOrigin()):Normalized() )
	ParticleManager:ReleaseParticleIndex( effect_cast )


end
function item_abyss_horn:PlayEffects4( target )
	-- Load effects
	local particle_cast = "particles/holy_light.vpcf"



	
	
	local effect_cast = ParticleManager:CreateParticle( particle_cast, PATTACH_ABSORIGIN_FOLLOW, target )
	ParticleManager:SetParticleControlEnt(
		effect_cast,
		0,
		target,
		PATTACH_POINT_FOLLOW,
		"attach_hitloc",
		target:GetOrigin(), -- unknown
		true -- unknown, true
	)
	ParticleManager:SetParticleControlForward( effect_cast, 1, (self:GetParent():GetOrigin()-target:GetOrigin()):Normalized() )
	ParticleManager:ReleaseParticleIndex( effect_cast )


end
function item_abyss_horn:PlayEffects5( target )
	-- Load effects
	local particle_cast = "particles/halo_7_explosion.vpcf"



	
	
	local effect_cast = ParticleManager:CreateParticle( particle_cast, PATTACH_ABSORIGIN_FOLLOW, target )
	ParticleManager:SetParticleControlEnt(
		effect_cast,
		0,
		target,
		PATTACH_POINT_FOLLOW,
		"attach_hitloc",
		target:GetOrigin(), -- unknown
		true -- unknown, true
	)
	ParticleManager:SetParticleControlForward( effect_cast, 1, (self:GetParent():GetOrigin()-target:GetOrigin()):Normalized() )
	ParticleManager:ReleaseParticleIndex( effect_cast )


end

function item_abyss_horn:PlayEffects6( target )
	-- Load effects
	local particle_cast = "particles/kuroalice_necro_strike.vpcf"



	
	
	local effect_cast = ParticleManager:CreateParticle( particle_cast, PATTACH_ABSORIGIN_FOLLOW, target )
	ParticleManager:SetParticleControlEnt(
		effect_cast,
		0,
		target,
		PATTACH_POINT_FOLLOW,
		"attach_hitloc",
		target:GetOrigin(), -- unknown
		true -- unknown, true
	)
	ParticleManager:SetParticleControlForward( effect_cast, 1, (self:GetParent():GetOrigin()-target:GetOrigin()):Normalized() )
	ParticleManager:ReleaseParticleIndex( effect_cast )


end
function item_abyss_horn:PlayEffects7( target )
	-- Load effects
	local particle_cast = "particles/kuroalice_necro_strike_lvl2.vpcf"



	
	
	local effect_cast = ParticleManager:CreateParticle( particle_cast, PATTACH_ABSORIGIN_FOLLOW, target )
	ParticleManager:SetParticleControlEnt(
		effect_cast,
		0,
		target,
		PATTACH_POINT_FOLLOW,
		"attach_hitloc",
		target:GetOrigin(), -- unknown
		true -- unknown, true
	)
	ParticleManager:SetParticleControlForward( effect_cast, 1, (self:GetParent():GetOrigin()-target:GetOrigin()):Normalized() )
	ParticleManager:ReleaseParticleIndex( effect_cast )


end
function item_abyss_horn:PlayEffects8( target )
	-- Load effects
	local particle_cast = "particles/econ/items/nightstalker/nightstalker_black_nihility/nightstalker_black_nihility_void_hit.vpcf"



	
	
	local effect_cast = ParticleManager:CreateParticle( particle_cast, PATTACH_ABSORIGIN_FOLLOW, target )
	ParticleManager:SetParticleControlEnt(
		effect_cast,
		0,
		target,
		PATTACH_POINT_FOLLOW,
		"attach_hitloc",
		target:GetOrigin(), -- unknown
		true -- unknown, true
	)
	ParticleManager:SetParticleControlForward( effect_cast, 1, (self:GetParent():GetOrigin()-target:GetOrigin()):Normalized() )
	ParticleManager:ReleaseParticleIndex( effect_cast )


end
function item_abyss_horn:PlayEffects9( target )
	-- Load effects
	local particle_cast = "particles/halo_10_portal.vpcf"



	
	
	local effect_cast = ParticleManager:CreateParticle( particle_cast, PATTACH_ABSORIGIN_FOLLOW, target )
	ParticleManager:SetParticleControlEnt(
		effect_cast,
		0,
		target,
		PATTACH_POINT_FOLLOW,
		"attach_hitloc",
		target:GetOrigin(), -- unknown
		true -- unknown, true
	)
	ParticleManager:SetParticleControlForward( effect_cast, 1, (self:GetParent():GetOrigin()-target:GetOrigin()):Normalized() )
	ParticleManager:ReleaseParticleIndex( effect_cast )


end
function item_abyss_horn:PlayEffects10( target )
	-- Load effects
	local particle_cast = "particles/halo_dark.vpcf"



	
	
	local effect_cast = ParticleManager:CreateParticle( particle_cast, PATTACH_ABSORIGIN_FOLLOW, target )
	ParticleManager:SetParticleControlEnt(
		effect_cast,
		0,
		target,
		PATTACH_POINT_FOLLOW,
		"attach_hitloc",
		target:GetOrigin(), -- unknown
		true -- unknown, true
	)
	ParticleManager:SetParticleControlForward( effect_cast, 1, (self:GetParent():GetOrigin()-target:GetOrigin()):Normalized() )
	ParticleManager:ReleaseParticleIndex( effect_cast )


end
function item_abyss_horn:PlayEffects12( target )
	-- Load effects
	local particle_cast = "particles/halo_stage_10_true_crit.vpcf"



	
	
	local effect_cast = ParticleManager:CreateParticle( particle_cast, PATTACH_ABSORIGIN_FOLLOW, target )
	ParticleManager:SetParticleControlEnt(
		effect_cast,
		0,
		target,
		PATTACH_POINT_FOLLOW,
		"attach_hitloc",
		target:GetOrigin(), -- unknown
		true -- unknown, true
	)
	ParticleManager:SetParticleControlForward( effect_cast, 1, (self:GetParent():GetOrigin()-target:GetOrigin()):Normalized() )
	ParticleManager:ReleaseParticleIndex( effect_cast )


end
function item_abyss_horn:PlayEffects16( target )
	-- Load effects
	local particle_cast = "particles/halo_lust_armor_active_awaken.vpcf"



	
	
	local effect_cast = ParticleManager:CreateParticle( particle_cast, PATTACH_ABSORIGIN_FOLLOW, target )
	ParticleManager:SetParticleControlEnt(
		effect_cast,
		0,
		target,
		PATTACH_POINT_FOLLOW,
		"attach_hitloc",
		target:GetOrigin(), -- unknown
		true -- unknown, true
	)
	ParticleManager:SetParticleControlForward( effect_cast, 1, (self:GetParent():GetOrigin()-target:GetOrigin()):Normalized() )
	ParticleManager:ReleaseParticleIndex( effect_cast )


end
function item_abyss_horn:PlayEffects15( target )
	-- Load effects
	local particle_cast = "particles/halo_lust_armor_active_sealed.vpcf"



	
	
	local effect_cast = ParticleManager:CreateParticle( particle_cast, PATTACH_ABSORIGIN_FOLLOW, target )
	ParticleManager:SetParticleControlEnt(
		effect_cast,
		0,
		target,
		PATTACH_POINT_FOLLOW,
		"attach_hitloc",
		target:GetOrigin(), -- unknown
		true -- unknown, true
	)
	ParticleManager:SetParticleControlForward( effect_cast, 1, (self:GetParent():GetOrigin()-target:GetOrigin()):Normalized() )
	ParticleManager:ReleaseParticleIndex( effect_cast )


end
function item_abyss_horn:PlayEffects20( target )
	-- Load effects
	local particle_cast = "particles/samurai_slash_0.vpcf"



	
	
	local effect_cast = ParticleManager:CreateParticle( particle_cast, PATTACH_ABSORIGIN_FOLLOW, target )
	ParticleManager:SetParticleControlEnt(
		effect_cast,
		0,
		target,
		PATTACH_POINT_FOLLOW,
		"attach_hitloc",
		target:GetOrigin(), -- unknown
		true -- unknown, true
	)
	ParticleManager:SetParticleControlForward( effect_cast, 1, (self:GetParent():GetOrigin()-target:GetOrigin()):Normalized() )
	ParticleManager:ReleaseParticleIndex( effect_cast )


end
function item_abyss_horn:PlayEffects21( target )
	-- Load effects
	local particle_cast = "particles/samura_slash1.vpcf"



	
	
	local effect_cast = ParticleManager:CreateParticle( particle_cast, PATTACH_ABSORIGIN_FOLLOW, target )
	ParticleManager:SetParticleControlEnt(
		effect_cast,
		0,
		target,
		PATTACH_POINT_FOLLOW,
		"attach_hitloc",
		target:GetOrigin(), -- unknown
		true -- unknown, true
	)
	ParticleManager:SetParticleControlForward( effect_cast, 1, (self:GetParent():GetOrigin()-target:GetOrigin()):Normalized() )
	ParticleManager:ReleaseParticleIndex( effect_cast )


end
function item_abyss_horn:PlayEffects22( target )
	-- Load effects
	local particle_cast = "particles/samura_slash2.vpcf"



	
	
	local effect_cast = ParticleManager:CreateParticle( particle_cast, PATTACH_ABSORIGIN_FOLLOW, target )
	ParticleManager:SetParticleControlEnt(
		effect_cast,
		0,
		target,
		PATTACH_POINT_FOLLOW,
		"attach_hitloc",
		target:GetOrigin(), -- unknown
		true -- unknown, true
	)
	ParticleManager:SetParticleControlForward( effect_cast, 1, (self:GetParent():GetOrigin()-target:GetOrigin()):Normalized() )
	ParticleManager:ReleaseParticleIndex( effect_cast )


end
function item_abyss_horn:PlayEffects23( target )
	-- Load effects
	local particle_cast = "particles/samura_slash3.vpcf"



	
	
	local effect_cast = ParticleManager:CreateParticle( particle_cast, PATTACH_ABSORIGIN_FOLLOW, target )
	ParticleManager:SetParticleControlEnt(
		effect_cast,
		0,
		target,
		PATTACH_POINT_FOLLOW,
		"attach_hitloc",
		target:GetOrigin(), -- unknown
		true -- unknown, true
	)
	ParticleManager:SetParticleControlForward( effect_cast, 1, (self:GetParent():GetOrigin()-target:GetOrigin()):Normalized() )
	ParticleManager:ReleaseParticleIndex( effect_cast )


end
function item_abyss_horn:PlayEffects24( target )
	-- Load effects
	local particle_cast = "particles/samura_slash4.vpcf"



	
	
	local effect_cast = ParticleManager:CreateParticle( particle_cast, PATTACH_ABSORIGIN_FOLLOW, target )
	ParticleManager:SetParticleControlEnt(
		effect_cast,
		0,
		target,
		PATTACH_POINT_FOLLOW,
		"attach_hitloc",
		target:GetOrigin(), -- unknown
		true -- unknown, true
	)
	ParticleManager:SetParticleControlForward( effect_cast, 1, (self:GetParent():GetOrigin()-target:GetOrigin()):Normalized() )
	ParticleManager:ReleaseParticleIndex( effect_cast )


end
function item_abyss_horn:PlayEffects25( target )
	-- Load effects
	local particle_cast = "particles/samura_slash5.vpcf"



	
	
	local effect_cast = ParticleManager:CreateParticle( particle_cast, PATTACH_ABSORIGIN_FOLLOW, target )
	ParticleManager:SetParticleControlEnt(
		effect_cast,
		0,
		target,
		PATTACH_POINT_FOLLOW,
		"attach_hitloc",
		target:GetOrigin(), -- unknown
		true -- unknown, true
	)
	ParticleManager:SetParticleControlForward( effect_cast, 1, (self:GetParent():GetOrigin()-target:GetOrigin()):Normalized() )
	ParticleManager:ReleaseParticleIndex( effect_cast )


end
modifier_abyss_choice = class({})
function modifier_abyss_choice:IsHidden() return false end
function modifier_abyss_choice:IsDebuff() return false end
function modifier_abyss_choice:IsPurgable() return false end
function modifier_abyss_choice:IsPurgeException() return false end
function modifier_abyss_choice:RemoveOnDeath() return false end
function modifier_abyss_choice:DeclareFunctions()
	local func = {	
					

					MODIFIER_PROPERTY_TRANSLATE_ACTIVITY_MODIFIERS,

				
					}
	return func
end
function modifier_abyss_choice:OnCreated( kv )
	-- get references

	

	if IsServer() then
		self:SetStackCount(1)
	end

end
function modifier_abyss_choice:OnDestroy()

local stack = self:GetStackCount()
local caster = self:GetCaster()
if stack == 1 then
caster:AddNewModifier(caster, self, "modifier_hero_route", {})
elseif stack == 2 then
caster:AddNewModifier(caster, self, "modifier_demon_route", {})
else
caster:AddNewModifier(caster, self, "modifier_samurai_route", {})
end
caster:AddNewModifier(caster, self, "modifier_abyss_chosed", {})
 end
function modifier_abyss_choice:OnStackCountChanged(iStackCount)
	if IsServer() then
		self:ForceRefresh()
		self.parent = self:GetParent()

		if self.Charge_FX then
			ParticleManager:DestroyParticle(self.Charge_FX, false)
			ParticleManager:ReleaseParticleIndex(self.Charge_FX)
		end

	

		local stacks = self:GetStackCount()

		if stacks == 1 then
			self.Charge_FX =   	ParticleManager:CreateParticle("particles/horn_choice.vpcf", PATTACH_OVERHEAD_FOLLOW, self.parent)
								
	                 
																		
	                            
		elseif stacks == 2 then
	  		self.Charge_FX =   	ParticleManager:CreateParticle("particles/horn_choice2.vpcf", PATTACH_OVERHEAD_FOLLOW, self.parent)
                            	

	  		

		else
	  		self.Charge_FX =   	ParticleManager:CreateParticle("particles/horn_choice3.vpcf", PATTACH_OVERHEAD_FOLLOW, self.parent)
                            

	  	
        end
	end
end

function modifier_abyss_choice:GetAbilityTextureName()
	
	return "angel_halo"
end
modifier_abyss_chosed = class({})
function modifier_abyss_chosed:IsHidden() return false end
function modifier_abyss_chosed:IsDebuff() return false end
function modifier_abyss_chosed:IsPurgable() return false end
function modifier_abyss_chosed:IsPurgeException() return false end
function modifier_abyss_chosed:RemoveOnDeath() return false end

function modifier_abyss_chosed:OnCreated( kv )
	-- get references
	self.kill = 800
	

	if IsServer() then
		self:SetStackCount(0)
	end
	self:StartIntervalThink(1.0)
end
function modifier_abyss_chosed:OnIntervalThink()
local caster = self:GetParent()
local stack = self:GetStackCount()
local target = caster
local Player = PlayerResource:GetPlayer(caster:GetPlayerID())
	   local kills = PlayerResource:GetKills(caster:GetPlayerID())
	   local death = PlayerResource:GetDeaths(caster:GetPlayerID())
if GameRules:GetGameTime() > 2400 then
self:AddStack(2)
else
self:AddStack(1)
end
if not caster:HasModifier("modifier_samurai_route_true") and not caster:HasModifier("modifier_samurai_route_alt") and not caster:HasModifier("modifier_demon_route_true") and not caster:HasModifier("modifier_hero_route_true") and not caster:HasModifier("modifier_demon_route_alt") and not caster:HasModifier("modifier_hero_route_alt") then
 if stack == 800 then
if caster:HasModifier("modifier_samurai_route")  then
if kills - death > 11 then
target:AddNewModifier(caster, self, "modifier_samurai_route_true", {})
else
target:AddNewModifier(caster, self, "modifier_samurai_route_alt", {})
end
elseif caster:HasModifier("modifier_demon_route") then
if kills > 17 then
target:AddNewModifier(caster, self, "modifier_demon_route_true", {})
else
target:AddNewModifier(caster, self, "modifier_demon_route_alt", {})
end

elseif caster:HasModifier("modifier_hero_route") then

if death < 15 then
target:AddNewModifier(caster, self, "modifier_hero_route_true", {})

else

target:AddNewModifier(caster, self, "modifier_hero_route_alt", {})
end

end
end
end
end
function modifier_abyss_chosed:OnRefresh( kv )

	local max_stack = 800

	if IsServer() then
		if self:GetStackCount()<max_stack then
			self:IncrementStackCount()
		end
	end
end

function modifier_abyss_chosed:AddStack( value )
	local current = self:GetStackCount()
	local after = current + value
		if after > self.kill then
			after = self.kill
		end
	self:SetStackCount( after )
end
function modifier_abyss_chosed:GetAbilityTextureName()
	
	return "angel_halo"
end

modifier_hero_route = class({})
function modifier_hero_route:IsHidden() return false end
function modifier_hero_route:IsDebuff() return false end
function modifier_hero_route:IsPurgable() return false end
function modifier_hero_route:IsPurgeException() return false end
function modifier_hero_route:RemoveOnDeath() return false end


modifier_hero_route_true = class({})
function modifier_hero_route_true:IsHidden() return true end
function modifier_hero_route_true:IsDebuff() return false end
function modifier_hero_route_true:IsPurgable() return false end
function modifier_hero_route_true:IsPurgeException() return false end
function modifier_hero_route_true:RemoveOnDeath() return false end


modifier_hero_route_alt = class({})
function modifier_hero_route_alt:IsHidden() return true end
function modifier_hero_route_alt:IsDebuff() return false end
function modifier_hero_route_alt:IsPurgable() return false end
function modifier_hero_route_alt:IsPurgeException() return false end
function modifier_hero_route_alt:RemoveOnDeath() return false end



modifier_demon_route_alt = class({})
function modifier_demon_route_alt:IsHidden() return true end
function modifier_demon_route_alt:IsDebuff() return false end
function modifier_demon_route_alt:IsPurgable() return false end
function modifier_demon_route_alt:IsPurgeException() return false end
function modifier_demon_route_alt:RemoveOnDeath() return false end



modifier_demon_route_true = class({})
function modifier_demon_route_true:IsHidden() return true end
function modifier_demon_route_true:IsDebuff() return false end
function modifier_demon_route_true:IsPurgable() return false end
function modifier_demon_route_true:IsPurgeException() return false end
function modifier_demon_route_true:RemoveOnDeath() return false end




modifier_samurai_route_true = class({})
function modifier_samurai_route_true:IsHidden() return true end
function modifier_samurai_route_true:IsDebuff() return false end
function modifier_samurai_route_true:IsPurgable() return false end
function modifier_samurai_route_true:IsPurgeException() return false end
function modifier_samurai_route_true:RemoveOnDeath() return false end




modifier_samurai_route_alt = class({})
function modifier_samurai_route_alt:IsHidden() return true end
function modifier_samurai_route_alt:IsDebuff() return false end
function modifier_samurai_route_alt:IsPurgable() return false end
function modifier_samurai_route_alt:IsPurgeException() return false end
function modifier_samurai_route_alt:RemoveOnDeath() return false end

modifier_demon_route = class({})
function modifier_demon_route:IsHidden() return false end
function modifier_demon_route:IsDebuff() return false end
function modifier_demon_route:IsPurgable() return false end
function modifier_demon_route:IsPurgeException() return false end
function modifier_demon_route:RemoveOnDeath() return false end

modifier_samurai_route = class({})
function modifier_samurai_route:IsHidden() return false end
function modifier_samurai_route:IsDebuff() return false end
function modifier_samurai_route:IsPurgable() return false end
function modifier_samurai_route:IsPurgeException() return false end
function modifier_samurai_route:RemoveOnDeath() return false end


modifier_abyss_start = class({})
function modifier_abyss_start:IsHidden() return false end
function modifier_abyss_start:IsDebuff() return false end
function modifier_abyss_start:IsPurgable() return false end
function modifier_abyss_start:IsPurgeException() return false end
function modifier_abyss_start:RemoveOnDeath() return true end
---------------------------------------------------------------------------------------------------------------------
modifier_item_abyss_horn = class({})
function modifier_item_abyss_horn:IsHidden() return true end
function modifier_item_abyss_horn:IsDebuff() return false end
function modifier_item_abyss_horn:IsPurgable() return false end
function modifier_item_abyss_horn:IsPurgeException() return false end
function modifier_item_abyss_horn:RemoveOnDeath() return false end

function modifier_item_abyss_horn:GetAttributes()
    return MODIFIER_ATTRIBUTE_MULTIPLE
end
function modifier_item_abyss_horn:DeclareFunctions()
	local func = { MODIFIER_PROPERTY_STATS_STRENGTH_BONUS,
        MODIFIER_PROPERTY_STATS_AGILITY_BONUS,
        MODIFIER_PROPERTY_STATS_INTELLECT_BONUS,
					MODIFIER_PROPERTY_MOVESPEED_BONUS_CONSTANT,
					  MODIFIER_PROPERTY_PREATTACK_BONUS_DAMAGE,
        MODIFIER_PROPERTY_HEALTH_BONUS,
		MODIFIER_PROPERTY_PHYSICAL_ARMOR_BONUS,
		MODIFIER_PROPERTY_SPELL_AMPLIFY_PERCENTAGE,
		 MODIFIER_PROPERTY_MANA_BONUS,
				
					}
	return func
end
function modifier_item_abyss_horn:GetModifierPreAttack_BonusDamage()
    return self:GetAbility():GetSpecialValueFor('attack')
end
function modifier_item_abyss_horn:GetModifierManaBonus()
    return self:GetAbility():GetSpecialValueFor('mana')
end
function modifier_item_abyss_horn:GetModifierHealthBonus()
    return self:GetAbility():GetSpecialValueFor('mana')
end

function modifier_item_abyss_horn:GetModifierMoveSpeedBonus_Constant()

	return 20
	end

function modifier_item_abyss_horn:GetModifierBonusStats_Strength()
    return self:GetAbility():GetSpecialValueFor('all_stats')
end

function modifier_item_abyss_horn:GetModifierBonusStats_Agility()
    return self:GetAbility():GetSpecialValueFor('all_stats')
end

function modifier_item_abyss_horn:GetModifierBonusStats_Intellect()
    return self:GetAbility():GetSpecialValueFor('all_stats')
end



---------------------------------------------------------------------------------------------------------------------
modifier_abyss_horn_cd = class({})
function modifier_abyss_horn_cd:IsHidden() return false end
function modifier_abyss_horn_cd:IsDebuff() return false end
function modifier_abyss_horn_cd:IsPurgable() return false end
function modifier_abyss_horn_cd:IsPurgeException() return false end
function modifier_abyss_horn_cd:RemoveOnDeath() return false end

















-----------------------------------------------------------------------
modifier_hero_route_1 = class({})

function modifier_hero_route_1:IsHidden()
	return false
end
function modifier_hero_route_1:RemoveOnDeath() return true end
function modifier_hero_route_1:AllowIllusionDuplicate()
	return true
end
function modifier_hero_route_1:OnCreated()
self:StopAllMusic()
local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
EmitSoundOnClient("horn.hero_1", Player) 

 end
 function modifier_hero_route_1:OnDestroy()

local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
StopSoundOn("horn.hero_1", Player)
 self.ability = self:GetAbility()
	self.ability:EndCooldown()
	 self.ability:StartCooldown(30)	
 end
function modifier_hero_route_1:IsPurgable()
    return false
end

function modifier_hero_route_1:DeclareFunctions()
    local funcs = {
        MODIFIER_PROPERTY_PREATTACK_BONUS_DAMAGE,
		 MODIFIER_PROPERTY_HEALTH_BONUS,
		 MODIFIER_EVENT_ON_ATTACK_LANDED,
		
		
    }

    return funcs
end
function modifier_hero_route_1:OnAttackLanded(params)
	if IsServer() then
	self.crit_chance = 25
		if params.attacker == self:GetParent() then	
			if not params.attacker:IsIllusion() then
			if RandomInt(0, 100)<self.crit_chance then
			local caster = self:GetParent()
			local damage =  caster:GetBaseDamageMax()
	
			local damageTable = {
		attacker = self:GetParent(),
		damage = damage,
		damage_type = DAMAGE_TYPE_PHYSICAL,
		ability = self,
	}
	damageTable.victim = params.target
		ApplyDamage(damageTable)
		self:GetParent():EmitSound("halo.attack")
			end
		end
	end
	end
	
end
function modifier_hero_route_1:GetModifierPreAttack_BonusDamage()
    return 2
end

function modifier_hero_route_1:GetModifierHealthBonus()

	return 200
	end
	

function modifier_hero_route_1:GetTexture()
	return "angel_halo"
end
function modifier_hero_route_1:GetEffectName()
	return "particles/halo_stage_0.vpcf"
end
function modifier_hero_route_1:StopAllMusic()
local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
	if IsServer() then
			for i = 1, 30 do
			StopSoundOn("star.theme_"..i, Player)
		end
		  for i = 1, 6  do
			StopSoundOn("horn.hero_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("horn.demon_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("horn.samurai_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("spamton.theme_"..i, Player)
		end
	 for i = 1, 8  do
			StopSoundOn("new.year_theme_"..i, Player)
		end
end

end

modifier_hero_route_2 = class({})

function modifier_hero_route_2:IsHidden()
	return false
end
function modifier_hero_route_2:RemoveOnDeath() return true end
function modifier_hero_route_2:AllowIllusionDuplicate()
	return true
end
function modifier_hero_route_2:OnCreated()
self:StopAllMusic()
local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
EmitSoundOnClient("horn.hero_2", Player) 

 end
 function modifier_hero_route_2:OnDestroy()

local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
StopSoundOn("horn.hero_2", Player)
 self.ability = self:GetAbility()
	self.ability:EndCooldown()
	 self.ability:StartCooldown(35)	
 end
function modifier_hero_route_2:IsPurgable()
    return false
end

function modifier_hero_route_2:DeclareFunctions()
    local funcs = {
        MODIFIER_PROPERTY_PREATTACK_BONUS_DAMAGE,
		 MODIFIER_PROPERTY_HEALTH_BONUS,
		 MODIFIER_EVENT_ON_ATTACK_LANDED,
		
		
    }

    return funcs
end
function modifier_hero_route_2:OnAttackLanded(params)
	if IsServer() then	
		if params.attacker == self:GetParent() then	
			if not params.attacker:IsIllusion() then
			local caster = self:GetParent()
			local damage = 1/100*self:GetParent():GetHealth()
			local damageTable = {
		attacker = self:GetParent(),
		damage = damage,
		damage_type = DAMAGE_TYPE_PHYSICAL,
		ability = self,
	}
	damageTable.victim = params.target
		ApplyDamage(damageTable)
			end
		end
	end
	end
	

function modifier_hero_route_2:GetModifierPreAttack_BonusDamage()
    return 10
end

function modifier_hero_route_2:GetModifierHealthBonus()

	return 300
	end
	

function modifier_hero_route_2:GetTexture()
	return "angel_halo"
end
function modifier_hero_route_2:GetEffectName()
	return "particles/halo_stage_2.vpcf"
end
function modifier_hero_route_2:StopAllMusic()

	local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
	if IsServer() then
		for i = 1, 30 do
			StopSoundOn("star.theme_"..i, Player)
		end
		  for i = 1, 6  do
			StopSoundOn("horn.hero_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("horn.demon_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("horn.samurai_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("spamton.theme_"..i, Player)
		end
	 for i = 1, 8  do
			StopSoundOn("new.year_theme_"..i, Player)
		end
end

end


modifier_hero_route_3 = class({})

function modifier_hero_route_3:IsHidden()
	return false
end
function modifier_hero_route_3:RemoveOnDeath() return true end
function modifier_hero_route_3:AllowIllusionDuplicate()
	return true
end
function modifier_hero_route_3:OnCreated()
self:StopAllMusic()
local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
EmitSoundOnClient("horn.hero_3", Player) 

 end
 function modifier_hero_route_3:OnDestroy()

local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
StopSoundOn("horn.hero_3", Player)
 self.ability = self:GetAbility()
	self.ability:EndCooldown()
	 self.ability:StartCooldown(40)	
 end
function modifier_hero_route_3:IsPurgable()
    return false
end

function modifier_hero_route_3:DeclareFunctions()
    local funcs = {
        MODIFIER_PROPERTY_PREATTACK_BONUS_DAMAGE,
		 MODIFIER_PROPERTY_HEALTH_BONUS,
		 MODIFIER_EVENT_ON_ATTACK_LANDED,
		
		
    }

    return funcs
end
function modifier_hero_route_3:OnAttackLanded(params)
	if IsServer() then	
		if params.attacker == self:GetParent() then	
			if not params.attacker:IsIllusion() then
			local caster = self:GetParent()
			local damage = 1.5/100*self:GetParent():GetHealth()
			local damageTable = {
		attacker = self:GetParent(),
		damage = damage,
		damage_type = DAMAGE_TYPE_PHYSICAL,
		ability = self,
	}
	damageTable.victim = params.target
		ApplyDamage(damageTable)
			end
		end
	end
	end
	

function modifier_hero_route_3:GetModifierPreAttack_BonusDamage()
    return 20
end

function modifier_hero_route_3:GetModifierHealthBonus()

	return 400
	end
	

function modifier_hero_route_3:GetTexture()
	return "angel_halo"
end
function modifier_hero_route_3:GetEffectName()
	return "particles/halo_stage_4.vpcf"
end
function modifier_hero_route_3:StopAllMusic()
	local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
	if IsServer() then
		for i = 1, 30 do
			StopSoundOn("star.theme_"..i, Player)
		end
		  for i = 1, 6  do
			StopSoundOn("horn.hero_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("horn.demon_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("horn.samurai_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("spamton.theme_"..i, Player)
		end
	 for i = 1, 8  do
			StopSoundOn("new.year_theme_"..i, Player)
		end
end

end


modifier_hero_route_4 = class({})

function modifier_hero_route_4:IsHidden()
	return false
end
function modifier_hero_route_4:RemoveOnDeath() return true end
function modifier_hero_route_4:AllowIllusionDuplicate()
	return true
end
function modifier_hero_route_4:OnCreated()
self:StopAllMusic()
local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
EmitSoundOnClient("horn.hero_4", Player) 

 end
 function modifier_hero_route_4:OnDestroy()

local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
StopSoundOn("horn.hero_4", Player)
 self.ability = self:GetAbility()
	self.ability:EndCooldown()
	 self.ability:StartCooldown(45)	
 end
function modifier_hero_route_4:IsPurgable()
    return false
end

function modifier_hero_route_4:DeclareFunctions()
    local funcs = {
        MODIFIER_PROPERTY_PREATTACK_BONUS_DAMAGE,
		 MODIFIER_PROPERTY_HEALTH_BONUS,
		 MODIFIER_EVENT_ON_ATTACK_LANDED,
		
		
    }

    return funcs
end
function modifier_hero_route_4:OnAttackLanded(params)
	if IsServer() then	
		if params.attacker == self:GetParent() then	
			if not params.attacker:IsIllusion() then
			local caster = self:GetParent()
			local max_health = self:GetParent():GetMaxHealth()
			local health = self:GetParent():GetHealth()
			local damage = (max_health - health) * 0.03
			local damageTable = {
		attacker = self:GetParent(),
		damage = damage,
		damage_type = DAMAGE_TYPE_PHYSICAL,
		ability = self,
	}
	damageTable.victim = params.target
		ApplyDamage(damageTable)
			end
		end
	end
	end
	
function modifier_hero_route_4:GetModifierPreAttack_BonusDamage()
    return 25
end

function modifier_hero_route_4:GetModifierHealthBonus()

	return 500
	end
	

function modifier_hero_route_4:GetTexture()
	return "angel_halo"
end
function modifier_hero_route_4:GetEffectName()
	return "particles/halo_stage_9_alt.vpcf"
end
function modifier_hero_route_4:StopAllMusic()
	local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
	if IsServer() then
		for i = 1, 30 do
			StopSoundOn("star.theme_"..i, Player)
		end
		  for i = 1, 6  do
			StopSoundOn("horn.hero_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("horn.demon_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("horn.samurai_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("spamton.theme_"..i, Player)
		end
	 for i = 1, 8  do
			StopSoundOn("new.year_theme_"..i, Player)
		end
end

end













-------------------------------------------------
modifier_hero_route_5 = class({})

function modifier_hero_route_5:IsHidden()
	return false
end
function modifier_hero_route_5:RemoveOnDeath() return true end
function modifier_hero_route_5:AllowIllusionDuplicate()
	return false
end

function modifier_hero_route_5:IsPurgable()
    return false
end

function modifier_hero_route_5:OnCreated(kv)
local caster = self:GetCaster()
self.shit  = RandomInt(1,4)
self.parent = self:GetParent()
local delay = 0.02
Timers:CreateTimer(delay,function()
if self.shit == 1 then
 
            self.shit_time =    ParticleManager:CreateParticle("particles/water_halo.vpcf", PATTACH_ABSORIGIN_FOLLOW, self.parent)
			 self.shit_time2 =    ParticleManager:CreateParticle("particles/spirit_overhead1.vpcf", PATTACH_OVERHEAD_FOLLOW, self.parent)
                                    caster:AddNewModifier(caster, self, "modifier_halo_spirits_stats_1", {duration = 60})
        
self:PlayEffects(300)


elseif self.shit == 2 then


            self.shit_time3 =    ParticleManager:CreateParticle("particles/earth_halo.vpcf", PATTACH_ABSORIGIN_FOLLOW, self.parent)
             self.shit_time4 =    ParticleManager:CreateParticle("particles/spirit_overhead3.vpcf", PATTACH_OVERHEAD_FOLLOW, self.parent)                         
       caster:AddNewModifier(caster, self, "modifier_halo_spirits_stats_2", {duration = 60})
self:PlayEffects1(300)

elseif self.shit == 3 then

            self.shit_time5 =    ParticleManager:CreateParticle("particles/wind_halo.vpcf", PATTACH_ABSORIGIN_FOLLOW, self.parent)
                     self.shit_time6 =    ParticleManager:CreateParticle("particles/spirit_overhead2.vpcf", PATTACH_OVERHEAD_FOLLOW, self.parent)                             
        caster:AddNewModifier(caster, self, "modifier_halo_spirits_stats_3", {duration = 60})
self:PlayEffects2(300)
elseif self.shit == 4 then

  
            self.shit_time7 =    ParticleManager:CreateParticle("particles/fire_halo.vpcf", PATTACH_ABSORIGIN_FOLLOW, self.parent)
                         self.shit_time8 =    ParticleManager:CreateParticle("particles/spirit_overhead4.vpcf", PATTACH_OVERHEAD_FOLLOW, self.parent)
						 caster:AddNewModifier(caster, self, "modifier_halo_spirits_stats_4", {duration = 60})
self:PlayEffects3(300)		
end			
end)	 
        
if IsServer() then
		self:StopAllMusic()
local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
EmitSoundOnClient("horn.hero_5", Player) 

	end

end
function modifier_hero_route_5:OnRefresh()
end
function modifier_hero_route_5:PlayEffects( radius )

	local particle_cast = "particles/water_halo_start.vpcf"

	-- Create Particle
	local effect_cast = ParticleManager:CreateParticle( particle_cast, PATTACH_WORLDORIGIN, self:GetParent() )
	ParticleManager:SetParticleControl( effect_cast, 0, self:GetParent():GetOrigin() )
	ParticleManager:SetParticleControl( effect_cast, 1, Vector( radius, radius, radius ) )
	ParticleManager:ReleaseParticleIndex( effect_cast )

end
function modifier_hero_route_5:PlayEffects1( radius )

	local particle_cast = "particles/earth_halo_start.vpcf"

	-- Create Particle
	local effect_cast = ParticleManager:CreateParticle( particle_cast, PATTACH_WORLDORIGIN, self:GetParent() )
	ParticleManager:SetParticleControl( effect_cast, 0, self:GetParent():GetOrigin() )
	ParticleManager:SetParticleControl( effect_cast, 1, Vector( radius, radius, radius ) )
	ParticleManager:ReleaseParticleIndex( effect_cast )

end
function modifier_hero_route_5:PlayEffects2( radius )

	local particle_cast = "particles/wind_halo_start.vpcf"

	-- Create Particle
	local effect_cast = ParticleManager:CreateParticle( particle_cast, PATTACH_WORLDORIGIN, self:GetParent() )
	ParticleManager:SetParticleControl( effect_cast, 0, self:GetParent():GetOrigin() )
	ParticleManager:SetParticleControl( effect_cast, 1, Vector( radius, radius, radius ) )
	ParticleManager:ReleaseParticleIndex( effect_cast )

end
function modifier_hero_route_5:PlayEffects3( radius )

	local particle_cast = "particles/fire_halo_start.vpcf"

	-- Create Particle
	local effect_cast = ParticleManager:CreateParticle( particle_cast, PATTACH_WORLDORIGIN, self:GetParent() )
	ParticleManager:SetParticleControl( effect_cast, 0, self:GetParent():GetOrigin() )
	ParticleManager:SetParticleControl( effect_cast, 1, Vector( radius, radius, radius ) )
	ParticleManager:ReleaseParticleIndex( effect_cast )

end
function modifier_hero_route_5:OnDestroy()
if self.shit_time then
 ParticleManager:DestroyParticle(self.shit_time, false)
        ParticleManager:ReleaseParticleIndex(self.shit_time)
		end
		if self.shit_time2 then
		 ParticleManager:DestroyParticle(self.shit_time2, false)
        ParticleManager:ReleaseParticleIndex(self.shit_time2)
		end
		if self.shit_time3 then
		 ParticleManager:DestroyParticle(self.shit_time3, false)
        ParticleManager:ReleaseParticleIndex(self.shit_time3)
		end
		if self.shit_time4 then
		 ParticleManager:DestroyParticle(self.shit_time4, false)
        ParticleManager:ReleaseParticleIndex(self.shit_time4)
		end
		if self.shit_time5 then
		 ParticleManager:DestroyParticle(self.shit_time5, false)
        ParticleManager:ReleaseParticleIndex(self.shit_time5)
		end
		if self.shit_time6 then
		 ParticleManager:DestroyParticle(self.shit_time6, false)
        ParticleManager:ReleaseParticleIndex(self.shit_time6)
		end
		if self.shit_time7 then
		 ParticleManager:DestroyParticle(self.shit_time7, false)
        ParticleManager:ReleaseParticleIndex(self.shit_time7)
		end
		if self.shit_time8 then
		 ParticleManager:DestroyParticle(self.shit_time8, false)
        ParticleManager:ReleaseParticleIndex(self.shit_time8)
		end
		
			local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
StopSoundOn("horn.hero_5", Player)
			
			 self.ability = self:GetAbility()
	self.ability:EndCooldown()
	 self.ability:StartCooldown(80)	
end
function modifier_hero_route_5:DeclareFunctions()
    local funcs = {
        MODIFIER_PROPERTY_PREATTACK_BONUS_DAMAGE,
	MODIFIER_EVENT_ON_ATTACK_LANDED,
	MODIFIER_PROPERTY_MAGICAL_RESISTANCE_BONUS,
                    MODIFIER_PROPERTY_PHYSICAL_ARMOR_BONUS,
					MODIFIER_PROPERTY_MOVESPEED_BONUS_CONSTANT,
					   MODIFIER_PROPERTY_ATTACKSPEED_BONUS_CONSTANT,
		
		
    }

    return funcs
end


function modifier_hero_route_5:OnAttackLanded(params)
	if IsServer() then

		if params.attacker == self:GetParent() then	
			if not params.attacker:IsIllusion() then
			if self.shit == 1 then
			local damageTable = {
		attacker = self:GetParent(),
		damage =  100,
		damage_type = DAMAGE_TYPE_MAGICAL,
		ability = self,
	}
	damageTable.victim = params.target
		ApplyDamage(damageTable)
			params.target:AddNewModifier(self:GetCaster(), self:GetAbility(), "modifier_halo_water", {duration = 3 })

			elseif self.shit == 2 then
			params.target:AddNewModifier(self:GetCaster(), self:GetAbility(), "modifier_halo_earth", {duration = 3 })
		
			elseif self.shit == 3 then

			params.target:AddNewModifier(self:GetCaster(), self:GetAbility(), "modifier_halo_wind", {duration = 2 })
			else
	
			params.target:AddNewModifier(self:GetCaster(), self:GetAbility(), "modifier_halo_fire", {duration = 3 })
			
			end
		end
	end
	end
end

function modifier_hero_route_5:GetTexture()
	return "angel_halo"
end
function modifier_hero_route_5:StopAllMusic()
	local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
	if IsServer() then
		for i = 1, 30 do
			StopSoundOn("star.theme_"..i, Player)
		end
		  for i = 1, 6  do
			StopSoundOn("horn.hero_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("horn.demon_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("horn.samurai_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("spamton.theme_"..i, Player)
		end
		 for i = 1, 8  do
			StopSoundOn("new.year_theme_"..i, Player)
		end
	
end

end


modifier_halo_wind = class({})

function modifier_halo_wind:IsHidden()
	return false
end
function modifier_halo_wind:RemoveOnDeath() return true end
function modifier_halo_wind:AllowIllusionDuplicate()
	return true
end

function modifier_halo_wind:IsPurgable()
    return false
end

function modifier_halo_wind:DeclareFunctions()
    local funcs = {
        MODIFIER_PROPERTY_MOVESPEED_BONUS_CONSTANT,
       
        
		
    }

    return funcs
end

function modifier_halo_wind:GetModifierMoveSpeedBonus_Constant()

	return -75
	
end


function modifier_halo_wind:GetTexture()
	return "angel_halo"
end
function modifier_halo_wind:GetEffectName()
	return "particles/econ/items/windrunner/windranger_arcana/windranger_arcana_hud_ambient.vpcf"
end




modifier_halo_earth = class({})

function modifier_halo_earth:IsHidden()
	return false
end
function modifier_halo_earth:RemoveOnDeath() return true end
function modifier_halo_earth:AllowIllusionDuplicate()
	return true
end

function modifier_halo_earth:IsPurgable()
    return false
end

function modifier_halo_earth:DeclareFunctions()
    local funcs = {
        MODIFIER_PROPERTY_PHYSICAL_ARMOR_BONUS, 
       
        
		
    }

    return funcs
end

function modifier_halo_earth:GetModifierPhysicalArmorBonus()
    return -10
end


function modifier_halo_earth:GetTexture()
	return "angel_halo"
end
function modifier_halo_earth:GetEffectName()
	return "particles/earth_halo_debuff.vpcf"
end




modifier_halo_water = class({})

function modifier_halo_water:IsHidden()
	return false
end
function modifier_halo_water:RemoveOnDeath() return true end
function modifier_halo_water:AllowIllusionDuplicate()
	return false
end

function modifier_halo_water:IsPurgable()
    return false
end

function modifier_halo_water:DeclareFunctions()
    local funcs = {
        MODIFIER_PROPERTY_MAGICAL_RESISTANCE_BONUS,
        MODIFIER_PROPERTY_PHYSICAL_ARMOR_BONUS, 		
		
    }

    return funcs
end

function modifier_halo_water:GetModifierMagicalResistanceBonus()
    return -20
end


function modifier_halo_water:GetTexture()
	return "angel_halo"
end
function modifier_halo_water:GetEffectName()
	return "particles/water_halo_debuff.vpcf"
end



modifier_halo_fire = class({})

--------------------------------------------------------------------------------
-- Classifications
function modifier_halo_fire:IsHidden()
	return false
end

function modifier_halo_fire:IsDebuff()
	return true
end

function modifier_halo_fire:IsStunDebuff()
	return false
end

function modifier_halo_fire:IsPurgable()
	return true
end

--------------------------------------------------------------------------------
-- Initializations
function modifier_halo_fire:OnCreated( kv )
	-- references
	local damage = 3
	

	if not IsServer() then return end

	-- precache damage
	self.damageTable = {
		victim = self:GetParent(),
		attacker = self:GetCaster(),
		damage = damage,
		damage_type = DAMAGE_TYPE_PURE,
		ability = self:GetAbility(), --Optional.
	}
	-- ApplyDamage(damageTable)

	-- Start interval
	self:StartIntervalThink( 1 )
end

function modifier_halo_fire:OnRefresh( kv )
	-- references
	local damage = 3
	

	if not IsServer() then return end

	-- update damage
	self.damageTable.damage = damage	
end

function modifier_halo_fire:OnRemoved()
end

function modifier_halo_fire:OnDestroy()
end

-- Interval Effects
function modifier_halo_fire:OnIntervalThink()
	ApplyDamage( self.damageTable )
end

--------------------------------------------------------------------------------
-- Graphics & Animations
function modifier_halo_fire:GetEffectName()
	return "particles/econ/items/clinkz/clinkz_ti9_immortal/clinkz_ti9_summon_army.vpcf"
end

function modifier_halo_fire:GetEffectAttachType()
	return PATTACH_ABSORIGIN_FOLLOW
end



modifier_halo_spirits_stats_1 = class({})

function modifier_halo_spirits_stats_1:IsHidden()
	return true
end
function modifier_halo_spirits_stats_1:RemoveOnDeath() return true end
function modifier_halo_spirits_stats_1:AllowIllusionDuplicate()
	return false
end

function modifier_halo_spirits_stats_1:IsPurgable()
    return false
end

function modifier_halo_spirits_stats_1:DeclareFunctions()
    local funcs = {
	MODIFIER_PROPERTY_MAGICAL_RESISTANCE_BONUS,
	 MODIFIER_PROPERTY_HEALTH_BONUS, 
		
    }

    return funcs
end
function modifier_halo_spirits_stats_1:GetModifierMagicalResistanceBonus()

    return 12
	
end

function modifier_halo_spirits_stats_1:GetModifierHealthBonus()

	return 600
	end
modifier_halo_spirits_stats_2 = class({})

function modifier_halo_spirits_stats_2:IsHidden()
	return true
end
function modifier_halo_spirits_stats_2:RemoveOnDeath() return true end
function modifier_halo_spirits_stats_2:AllowIllusionDuplicate()
	return false
end

function modifier_halo_spirits_stats_2:IsPurgable()
    return false
end

function modifier_halo_spirits_stats_2:DeclareFunctions()
    local funcs = {
	MODIFIER_PROPERTY_PHYSICAL_ARMOR_BONUS,
	 MODIFIER_PROPERTY_HEALTH_BONUS,   
		
    }

    return funcs
end
function modifier_halo_spirits_stats_2:GetModifierPhysicalArmorBonus()

    return 10

end
function modifier_halo_spirits_stats_2:GetModifierHealthBonus()

	return 600
	end
modifier_halo_spirits_stats_3 = class({})

function modifier_halo_spirits_stats_3:IsHidden()
	return true
end
function modifier_halo_spirits_stats_3:RemoveOnDeath() return true end
function modifier_halo_spirits_stats_3:AllowIllusionDuplicate()
	return false
end

function modifier_halo_spirits_stats_3:IsPurgable()
    return false
end

function modifier_halo_spirits_stats_3:DeclareFunctions()
    local funcs = {
	MODIFIER_PROPERTY_MOVESPEED_BONUS_CONSTANT,
					   MODIFIER_PROPERTY_ATTACKSPEED_BONUS_CONSTANT,
					     MODIFIER_PROPERTY_HEALTH_BONUS,     
		
    }

    return funcs
end
function modifier_halo_spirits_stats_3:GetModifierMoveSpeedBonus_Constant()

	return 30

	end
	
function modifier_halo_spirits_stats_3:GetModifierAttackSpeedBonus_Constant()

	 return 30

end
function modifier_halo_spirits_stats_3:GetModifierHealthBonus()

	return 600
	end

modifier_halo_spirits_stats_4 = class({})

function modifier_halo_spirits_stats_4:IsHidden()
	return true
end
function modifier_halo_spirits_stats_4:RemoveOnDeath() return true end
function modifier_halo_spirits_stats_4:AllowIllusionDuplicate()
	return false
end

function modifier_halo_spirits_stats_4:IsPurgable()
    return false
end

function modifier_halo_spirits_stats_4:DeclareFunctions()
    local funcs = {
        MODIFIER_PROPERTY_PREATTACK_BONUS_DAMAGE,
MODIFIER_PROPERTY_HEALTH_BONUS, 		
		
    }

    return funcs
end
function modifier_halo_spirits_stats_4:GetModifierHealthBonus()

	return 600
	end

function modifier_halo_spirits_stats_4:GetModifierPreAttack_BonusDamage()
    return 5
end


--------------------------------------------------





modifier_hero_route_6 = class({})

function modifier_hero_route_6:IsHidden()
	return false
end
function modifier_hero_route_6:RemoveOnDeath() return true end
function modifier_hero_route_6:AllowIllusionDuplicate()
	return true
end
function modifier_hero_route_6:OnCreated()
self:StopAllMusic()
	self:PlayEffects()
local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
EmitSoundOnClient("horn.hero_6", Player) 
self.heal = self:GetParent():GetMaxHealth()
	self.heal1 = self.heal * 0.01
	self.radius = 600


	self:StartIntervalThink( 1 )
 end
 function modifier_hero_route_6:OnIntervalThink()

	local ally = FindUnitsInRadius(
		self:GetParent():GetTeamNumber(),	-- int, your team number
		self:GetParent():GetOrigin(),	-- point, center point
		nil,	-- handle, cacheUnit. (not known)
		600,	-- float, radius. or use FIND_UNITS_EVERYWHERE
		DOTA_UNIT_TARGET_TEAM_FRIENDLY,	-- int, team filter
		DOTA_UNIT_TARGET_HERO + DOTA_UNIT_TARGET_BASIC,	-- int, type filter
		0,	-- int, flag filter
		0,	-- int, order filter
		false	-- bool, can grow cache
	)

	for _,baka in pairs(ally) do
		-- apply damage
		baka:Heal( self.heal1, self:GetParent() )
	end

	
end
function modifier_hero_route_6:PlayEffects()
	-- get resources
	local particle_cast = "particles/hero_6_flash.vpcf"
	

	-- play particle
	local effect_cast = ParticleManager:CreateParticle( particle_cast, PATTACH_ABSORIGIN, self:GetParent() )
	ParticleManager:SetParticleControl( effect_cast, 0, self:GetParent():GetOrigin() )
	ParticleManager:SetParticleControl( effect_cast, 1, Vector( self.reincarnate_time, 0, 0 ) )
	ParticleManager:ReleaseParticleIndex( effect_cast )

	-- play sound

end
function modifier_hero_route_6:StopAllMusic()
	local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
	if IsServer() then
		for i = 1, 30 do
			StopSoundOn("star.theme_"..i, Player)
		end
		  for i = 1, 6  do
			StopSoundOn("horn.hero_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("horn.demon_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("horn.samurai_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("spamton.theme_"..i, Player)
		end
		 for i = 1, 8  do
			StopSoundOn("new.year_theme_"..i, Player)
		end
	
end

end
 function modifier_hero_route_6:OnDestroy()

local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
StopSoundOn("horn.hero_6", Player) 
 self.ability = self:GetAbility()
	self.ability:EndCooldown()
	 self.ability:StartCooldown(60)	
 end
function modifier_hero_route_6:IsPurgable()
    return false
end

function modifier_hero_route_6:DeclareFunctions()
    local funcs = {
        MODIFIER_PROPERTY_PREATTACK_BONUS_DAMAGE,
		 MODIFIER_PROPERTY_HEALTH_BONUS,
		 MODIFIER_EVENT_ON_ATTACK_LANDED,
		
		
    }

    return funcs
end
function modifier_hero_route_6:OnAttackLanded(params)
	if IsServer() then	
		if params.attacker == self:GetParent() then	
			if not params.attacker:IsIllusion() then
			local caster = self:GetParent()
			local max_health = self:GetParent():GetMaxHealth()
			local health = self:GetParent():GetHealth()
			local damage = (max_health - health) * 0.05
			local damageTable = {
		attacker = self:GetParent(),
		damage = damage,
		damage_type = DAMAGE_TYPE_PHYSICAL,
		ability = self,
	}
	damageTable.victim = params.target
		ApplyDamage(damageTable)
			end
		end
	end
	end
	
function modifier_hero_route_6:GetModifierPreAttack_BonusDamage()
    return 5
end

function modifier_hero_route_6:GetModifierHealthBonus()

	return 500
	end
	

function modifier_hero_route_6:GetTexture()
	return "angel_halo"
end
function modifier_hero_route_6:GetEffectName()
	return "particles/halo_stage_9_hero.vpcf"
end





---------------------------------------------------------




modifier_demon_route_1 = class({})

function modifier_demon_route_1:IsHidden()
	return false
end
function modifier_demon_route_1:RemoveOnDeath() return true end
function modifier_demon_route_1:AllowIllusionDuplicate()
	return true
end
function modifier_demon_route_1:OnCreated()
self:StopAllMusic()
local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
EmitSoundOnClient("horn.demon_1", Player) 

 end

 function modifier_demon_route_1:OnDestroy()

local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
StopSoundOn("horn.demon_1", Player)
 self.ability = self:GetAbility()
	self.ability:EndCooldown()
	 self.ability:StartCooldown(30)	
 end
function modifier_demon_route_1:IsPurgable()
    return false
end

function modifier_demon_route_1:DeclareFunctions()
    local funcs = {
        MODIFIER_PROPERTY_PREATTACK_BONUS_DAMAGE,
		 MODIFIER_PROPERTY_HEALTH_BONUS,
		 MODIFIER_EVENT_ON_ATTACK_LANDED,
		
		
    }

    return funcs
end
function modifier_demon_route_1:OnAttackLanded(params)
	if IsServer() then	
		if params.attacker == self:GetParent() then	
			if not params.attacker:IsIllusion() then
			local caster = self:GetParent()
			local max_health = self:GetParent():GetMaxHealth()
			local health = self:GetParent():GetHealth()
			local damage = 120
			local damageTable = {
		attacker = self:GetParent(),
		damage = damage,
		damage_type = DAMAGE_TYPE_MAGICAL,
		ability = self,
	}
	damageTable.victim = params.target
		ApplyDamage(damageTable)
		self.crit_chance = 2
		if RandomInt(0, 100)<self.crit_chance then
		params.target:AddNewModifier(self:GetCaster(), self:GetAbility(), "modifier_halo_slow", {duration = 2 })
			end
			end
		end
	end
	end
	


	

function modifier_demon_route_1:GetTexture()
	return "angel_halo"
end
function modifier_demon_route_1:GetEffectName()
	return "particles/halo_stage_9_1.vpcf"
end
function modifier_demon_route_1:StopAllMusic()
local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
	if IsServer() then
		for i = 1, 30 do
			StopSoundOn("star.theme_"..i, Player)
		end
		  for i = 1, 6  do
			StopSoundOn("horn.hero_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("horn.demon_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("horn.samurai_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("spamton.theme_"..i, Player)
		end
		 for i = 1, 8  do
			StopSoundOn("new.year_theme_"..i, Player)
		end
		end
end

modifier_demon_route_2 = class({})

function modifier_demon_route_2:IsHidden()
	return false
end
function modifier_demon_route_2:RemoveOnDeath() return true end
function modifier_demon_route_2:AllowIllusionDuplicate()
	return true
end
function modifier_demon_route_2:OnCreated()
self:StopAllMusic()
local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
EmitSoundOnClient("horn.demon_2", Player) 

 end

 function modifier_demon_route_2:OnDestroy()

local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
StopSoundOn("horn.demon_2", Player)
 self.ability = self:GetAbility()
	self.ability:EndCooldown()
	 self.ability:StartCooldown(35)	
 end
function modifier_demon_route_2:IsPurgable()
    return false
end

function modifier_demon_route_2:DeclareFunctions()
    local funcs = {
        MODIFIER_PROPERTY_PREATTACK_BONUS_DAMAGE,
		 MODIFIER_PROPERTY_HEALTH_BONUS,
		 MODIFIER_EVENT_ON_ATTACK_LANDED,
		
		
    }

    return funcs
end
function modifier_demon_route_2:OnAttackLanded(params)
	if IsServer() then	
		if params.attacker == self:GetParent() then	
			if not params.attacker:IsIllusion() then
			local caster = self:GetParent()
			local max_health = self:GetParent():GetMaxHealth()
			local health = self:GetParent():GetHealth()
			local damage = 120
			local damageTable = {
		attacker = self:GetParent(),
		damage = damage,
		damage_type = DAMAGE_TYPE_MAGICAL,
		ability = self,
	}
	damageTable.victim = params.target
		ApplyDamage(damageTable)
		self.crit_chance = 5
		if RandomInt(0, 100)<self.crit_chance then
		params.target:AddNewModifier(self:GetCaster(), self:GetAbility(), "modifier_halo_slow", {duration = 2 })
			end
			end
		end
	end
	end
	


	

function modifier_demon_route_2:GetTexture()
	return "angel_halo"
end
function modifier_demon_route_2:GetEffectName()
	return "particles/halo_stage_9_2_1.vpcf"
end
function modifier_demon_route_2:StopAllMusic()
	local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
	if IsServer() then
		for i = 1, 30 do
			StopSoundOn("star.theme_"..i, Player)
		end
		  for i = 1, 6  do
			StopSoundOn("horn.hero_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("horn.demon_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("horn.samurai_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("spamton.theme_"..i, Player)
		end
		 for i = 1, 8  do
			StopSoundOn("new.year_theme_"..i, Player)
		end
		end

end



modifier_demon_route_3 = class({})

function modifier_demon_route_3:IsHidden()
	return false
end
function modifier_demon_route_3:RemoveOnDeath() return true end
function modifier_demon_route_3:AllowIllusionDuplicate()
	return true
end
function modifier_demon_route_3:OnCreated()
self:StopAllMusic()
local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
EmitSoundOnClient("horn.demon_3", Player) 

 end

 function modifier_demon_route_3:OnDestroy()

local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
StopSoundOn("horn.demon_3", Player)
 self.ability = self:GetAbility()
	self.ability:EndCooldown()
	 self.ability:StartCooldown(40)	
 end
function modifier_demon_route_3:IsPurgable()
    return false
end

function modifier_demon_route_3:DeclareFunctions()
    local funcs = {
        MODIFIER_PROPERTY_PREATTACK_BONUS_DAMAGE,
		 MODIFIER_PROPERTY_HEALTH_BONUS,
		 MODIFIER_EVENT_ON_ATTACK_LANDED,
		
		
    }

    return funcs
end
function modifier_demon_route_3:OnAttackLanded(params)
	if IsServer() then	
		if params.attacker == self:GetParent() then	
			if not params.attacker:IsIllusion() then
			local caster = self:GetParent()
			local max_health = self:GetParent():GetMaxHealth()
			local health = self:GetParent():GetHealth()
			local damage = 200
			local damageTable = {
		attacker = self:GetParent(),
		damage = damage,
		damage_type = DAMAGE_TYPE_MAGICAL,
		ability = self,
	}
	damageTable.victim = params.target
		ApplyDamage(damageTable)
		self.crit_chance = 5
		if RandomInt(0, 100)<self.crit_chance then
		params.target:AddNewModifier(self:GetCaster(), self:GetAbility(), "modifier_halo_root", {duration = 0.8 })
			end
			end
		end
	end
	end
	


	

function modifier_demon_route_3:GetTexture()
	return "angel_halo"
end
function modifier_demon_route_3:GetEffectName()
	return "particles/halo_stage_8.vpcf"
end
function modifier_demon_route_3:StopAllMusic()
local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
	if IsServer() then
		for i = 1, 30 do
			StopSoundOn("star.theme_"..i, Player)
		end
		  for i = 1, 6  do
			StopSoundOn("horn.hero_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("horn.demon_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("horn.samurai_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("spamton.theme_"..i, Player)
		end
		 for i = 1, 8  do
			StopSoundOn("new.year_theme_"..i, Player)
		end
		end
end


modifier_demon_route_4 = class({})

function modifier_demon_route_4:IsHidden()
	return false
end
function modifier_demon_route_4:RemoveOnDeath() return true end
function modifier_demon_route_4:AllowIllusionDuplicate()
	return true
end
function modifier_demon_route_4:OnCreated()
self:StopAllMusic()
local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
EmitSoundOnClient("horn.demon_4", Player) 

 end

 function modifier_demon_route_4:OnDestroy()

local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
StopSoundOn("horn.demon_4", Player)
 self.ability = self:GetAbility()
	self.ability:EndCooldown()
	 self.ability:StartCooldown(45)	
 end
function modifier_demon_route_4:IsPurgable()
    return false
end

function modifier_demon_route_4:DeclareFunctions()
    local funcs = {
        MODIFIER_PROPERTY_PREATTACK_BONUS_DAMAGE,
		 MODIFIER_PROPERTY_HEALTH_BONUS,
		 MODIFIER_EVENT_ON_ATTACK_LANDED,
		
		
    }

    return funcs
end
function modifier_demon_route_4:OnAttackLanded(params)
	if IsServer() then	
		if params.attacker == self:GetParent() then	
			if not params.attacker:IsIllusion() then
			local caster = self:GetParent()
			local max_health = self:GetParent():GetMaxHealth()
			local health = self:GetParent():GetHealth()
			local damage = 200
			local damageTable = {
		attacker = self:GetParent(),
		damage = damage,
		damage_type = DAMAGE_TYPE_MAGICAL,
		ability = self,
	}
	damageTable.victim = params.target
		ApplyDamage(damageTable)
		self.crit_chance = 15
		if RandomInt(0, 100)<self.crit_chance then
		params.target:AddNewModifier(self:GetCaster(), self:GetAbility(), "modifier_halo_root", {duration = 0.8 })
			end
			end
		end
	end
	end
	


	

function modifier_demon_route_4:GetTexture()
	return "angel_halo"
end
function modifier_demon_route_4:GetEffectName()
	return "particles/halo_lust_armor_sealed.vpcf"
end
function modifier_demon_route_4:StopAllMusic()
local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
	if IsServer() then
			for i = 1, 30 do
			StopSoundOn("star.theme_"..i, Player)
		end
		  for i = 1, 6  do
			StopSoundOn("horn.hero_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("horn.demon_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("horn.samurai_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("spamton.theme_"..i, Player)
		end
		 for i = 1, 8  do
			StopSoundOn("new.year_theme_"..i, Player)
		end
		end

end











modifier_demon_route_5 = class({})

function modifier_demon_route_5:IsHidden()
	return false
end
function modifier_demon_route_5:RemoveOnDeath() return true end
function modifier_demon_route_5:AllowIllusionDuplicate()
	return true
end
function modifier_demon_route_5:OnCreated()
self:StopAllMusic()
local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
EmitSoundOnClient("horn.demon_5", Player) 


 end
function modifier_demon_route_5:StopAllMusic()
local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
	if IsServer() then
			for i = 1, 30 do
			StopSoundOn("star.theme_"..i, Player)
		end
		  for i = 1, 6  do
			StopSoundOn("horn.hero_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("horn.demon_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("horn.samurai_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("spamton.theme_"..i, Player)
		end
		 for i = 1, 8  do
			StopSoundOn("new.year_theme_"..i, Player)
		end
		end

end


 function modifier_demon_route_5:OnDestroy()


local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
StopSoundOn("horn.demon_5", Player) 
 self.ability = self:GetAbility()
	self.ability:EndCooldown()
	 self.ability:StartCooldown(60)	
 end
function modifier_demon_route_5:IsPurgable()
    return false
end

function modifier_demon_route_5:DeclareFunctions()
    local funcs = {
        MODIFIER_PROPERTY_PREATTACK_BONUS_DAMAGE,
		 MODIFIER_PROPERTY_HEALTH_BONUS,
		 MODIFIER_EVENT_ON_ATTACK_LANDED,
		  MODIFIER_PROPERTY_STATS_STRENGTH_BONUS,
        MODIFIER_PROPERTY_STATS_AGILITY_BONUS,
        MODIFIER_PROPERTY_STATS_INTELLECT_BONUS,
		
		
    }

    return funcs
end
function modifier_demon_route_5:GetModifierBonusStats_Strength()
    return 10
end

function modifier_demon_route_5:GetModifierBonusStats_Agility()
    return 10
end

function modifier_demon_route_5:GetModifierBonusStats_Intellect()
    return 10
end
function modifier_demon_route_5:OnAttackLanded(params)
	if IsServer() then	
		if params.attacker == self:GetParent() then	
			if not params.attacker:IsIllusion() then
			local caster = self:GetParent()
			local max_health = params.target:GetMaxHealth()
			self.crit_chance = 5
			if RandomInt(0, 100)<self.crit_chance then
			self.damage = max_health * 0.02
			else
			self.damage = 500
			end
			local damageTable = {
		attacker = self:GetParent(),
		damage = self.damage,
		damage_type = DAMAGE_TYPE_MAGICAL,
		ability = self,
	}
	damageTable.victim = params.target
		ApplyDamage(damageTable)
		
		
			end
		end
	end
	end
	


	

function modifier_demon_route_5:GetTexture()
	return "angel_halo"
end
function modifier_demon_route_5:GetEffectName()
	return "particles/halo_stage_10_buff.vpcf"
end



modifier_demon_route_6 = class({})

function modifier_demon_route_6:IsHidden()
	return false
end
function modifier_demon_route_6:RemoveOnDeath() return true end
function modifier_demon_route_6:AllowIllusionDuplicate()
	return true
end
function modifier_demon_route_6:OnCreated()
self:StopAllMusic()

local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
EmitSoundOnClient("horn.demon_6", Player) 

 end
function modifier_demon_route_6:StopAllMusic()
local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
	if IsServer() then
			for i = 1, 30 do
			StopSoundOn("star.theme_"..i, Player)
		end
		  for i = 1, 6  do
			StopSoundOn("horn.hero_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("horn.demon_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("horn.samurai_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("spamton.theme_"..i, Player)
		end
		 for i = 1, 8  do
			StopSoundOn("new.year_theme_"..i, Player)
		end
		end

end


 function modifier_demon_route_6:OnDestroy()

local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
StopSoundOn("horn.demon_6", Player) 
 self.ability = self:GetAbility()
	self.ability:EndCooldown()
	 self.ability:StartCooldown(60)	
 end
function modifier_demon_route_6:IsPurgable()
    return false
end

function modifier_demon_route_6:DeclareFunctions()
    local funcs = {
        MODIFIER_PROPERTY_PREATTACK_BONUS_DAMAGE,
		 MODIFIER_PROPERTY_HEALTH_BONUS,
		 MODIFIER_EVENT_ON_ATTACK_LANDED,
		  MODIFIER_PROPERTY_STATS_STRENGTH_BONUS,
        MODIFIER_PROPERTY_STATS_AGILITY_BONUS,
        MODIFIER_PROPERTY_STATS_INTELLECT_BONUS,
		
		
    }

    return funcs
end
function modifier_demon_route_6:GetModifierBonusStats_Strength()
    return 10
end

function modifier_demon_route_6:GetModifierBonusStats_Agility()
    return 10
end

function modifier_demon_route_6:GetModifierBonusStats_Intellect()
    return 10
end
function modifier_demon_route_6:OnAttackLanded(params)
	if IsServer() then	
		if params.attacker == self:GetParent() then	
			if not params.attacker:IsIllusion() then
			local caster = self:GetParent()
			local max_health = params.target:GetMaxHealth()
			self.crit_chance = 5
			if RandomInt(0, 100)<self.crit_chance then
			self.heal = max_health * 0.02
			self:GetParent():Heal(self.heal, nil)
		end
			self.damage = 400
			local damageTable = {
		attacker = self:GetParent(),
		damage = self.damage,
		damage_type = DAMAGE_TYPE_MAGICAL,
		ability = self,
	}
	damageTable.victim = params.target
		ApplyDamage(damageTable)
		
		
			end
		end
	end
	end
	


	

function modifier_demon_route_6:GetTexture()
	return "angel_halo"
end
function modifier_demon_route_6:GetEffectName()
	return "particles/halo_lust_armor_awakened.vpcf"
end

modifier_samurai_route_1 = class({})

function modifier_samurai_route_1:IsHidden()
	return false
end
function modifier_samurai_route_1:RemoveOnDeath() return true end
function modifier_samurai_route_1:AllowIllusionDuplicate()
	return true
end
function modifier_samurai_route_1:OnCreated()
self:StopAllMusic()
local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
EmitSoundOnClient("horn.samurai_1", Player) 

 end

 function modifier_samurai_route_1:OnDestroy()

local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
StopSoundOn("horn.samurai_1", Player)
 self.ability = self:GetAbility()
	self.ability:EndCooldown()
	 self.ability:StartCooldown(30)	
 end
function modifier_samurai_route_1:IsPurgable()
    return false
end

function modifier_samurai_route_1:DeclareFunctions()
    local funcs = {
        MODIFIER_PROPERTY_PREATTACK_BONUS_DAMAGE,
		MODIFIER_PROPERTY_PHYSICAL_ARMOR_BONUS,
		 MODIFIER_EVENT_ON_ATTACK_LANDED,

		
		
    }

    return funcs
end
  function modifier_samurai_route_1:GetModifierPhysicalArmorBonus()
return 5
end   
  function modifier_samurai_route_1:GetModifierPreAttack_BonusDamage()
return 100
end 
function modifier_samurai_route_1:OnAttackLanded(params)
	if IsServer() then
	self.chance = 35
	     if not self:GetParent():HasModifier("modifier_abyss_horn_cd") then
		if params.target~=self:GetCaster() then return end
		if params.attacker:GetTeamNumber()==params.target:GetTeamNumber() then return end
		if RandomInt(1,100)>self.chance then return end
		if not self:GetParent():IsStunned() then
			self:GetParent():PerformAttack(params.attacker, true,
				true,
				true,
				true,
				true,
				false,
				true)
		end
		self:GetParent():AddNewModifier(self:GetParent(), self, "modifier_abyss_horn_cd", {duration = 1.5})
		
		self:GetParent():EmitSound("halo.attack")
			end
		end
		end
	
	
	


	

function modifier_samurai_route_1:GetTexture()
	return "angel_halo"
end
function modifier_samurai_route_1:GetEffectName()
	return "particles/halo_stage_5.vpcf"
end
function modifier_samurai_route_1:StopAllMusic()
		local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
	if IsServer() then
		for i = 1, 30 do
			StopSoundOn("star.theme_"..i, Player)
		end
		  for i = 1, 6  do
			StopSoundOn("horn.hero_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("horn.demon_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("horn.samurai_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("spamton.theme_"..i, Player)
		end
		 for i = 1, 8  do
			StopSoundOn("new.year_theme_"..i, Player)
		end
	end
end




modifier_samurai_route_2 = class({})

function modifier_samurai_route_2:IsHidden()
	return false
end
function modifier_samurai_route_2:RemoveOnDeath() return true end
function modifier_samurai_route_2:AllowIllusionDuplicate()
	return true
end
function modifier_samurai_route_2:OnCreated()
self:StopAllMusic()
local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
EmitSoundOnClient("horn.samurai_2", Player) 

 end

 function modifier_samurai_route_2:OnDestroy()

local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
StopSoundOn("horn.samurai_2", Player)
 self.ability = self:GetAbility()
	self.ability:EndCooldown()
	 self.ability:StartCooldown(35)	
 end
function modifier_samurai_route_2:IsPurgable()
    return false
end

function modifier_samurai_route_2:DeclareFunctions()
    local funcs = {
        MODIFIER_PROPERTY_PREATTACK_BONUS_DAMAGE,
		MODIFIER_PROPERTY_PHYSICAL_ARMOR_BONUS,
		 MODIFIER_EVENT_ON_ATTACK_LANDED,

		
		
    }

    return funcs
end
  function modifier_samurai_route_2:GetModifierPhysicalArmorBonus()
return 7
end   
  function modifier_samurai_route_2:GetModifierPreAttack_BonusDamage()
return 125
end 
function modifier_samurai_route_2:OnAttackLanded(params)
	if IsServer() then
	self.chance = 45
	     if not self:GetParent():HasModifier("modifier_abyss_horn_cd") then
		if params.target~=self:GetCaster() then return end
		if params.attacker:GetTeamNumber()==params.target:GetTeamNumber() then return end
		if RandomInt(1,100)>self.chance then return end
		if not self:GetParent():IsStunned() then
			self:GetParent():PerformAttack(params.attacker, true,
				true,
				true,
				true,
				true,
				false,
				true)
		end
		self:GetParent():AddNewModifier(self:GetParent(), self, "modifier_abyss_horn_cd", {duration = 1.5})
		
		self:GetParent():EmitSound("halo.attack")
			end
		end
		end
	
	
	


	

function modifier_samurai_route_2:GetTexture()
	return "angel_halo"
end
function modifier_samurai_route_2:GetEffectName()
	return "particles/halo_stage_5_samurai_1.vpcf"
end
function modifier_samurai_route_2:StopAllMusic()
		local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
	if IsServer() then
		for i = 1, 30 do
			StopSoundOn("star.theme_"..i, Player)
		end
		  for i = 1, 6  do
			StopSoundOn("horn.hero_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("horn.demon_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("horn.samurai_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("spamton.theme_"..i, Player)
		end
		 for i = 1, 8  do
			StopSoundOn("new.year_theme_"..i, Player)
		end
	end
	
end





modifier_samurai_route_3 = class({})

function modifier_samurai_route_3:IsHidden()
	return false
end
function modifier_samurai_route_3:RemoveOnDeath() return true end
function modifier_samurai_route_3:AllowIllusionDuplicate()
	return true
end
function modifier_samurai_route_3:OnCreated()
self:StopAllMusic()
local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
EmitSoundOnClient("horn.samurai_3", Player) 

 end

 function modifier_samurai_route_3:OnDestroy()

local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
StopSoundOn("horn.samurai_3", Player)
 self.ability = self:GetAbility()
	self.ability:EndCooldown()
	 self.ability:StartCooldown(40)	
 end
function modifier_samurai_route_3:IsPurgable()
    return false
end

function modifier_samurai_route_3:DeclareFunctions()
    local funcs = {
        MODIFIER_PROPERTY_PREATTACK_BONUS_DAMAGE,
		MODIFIER_PROPERTY_PHYSICAL_ARMOR_BONUS,
		 MODIFIER_EVENT_ON_ATTACK_LANDED,

		
		
    }

    return funcs
end
  function modifier_samurai_route_3:GetModifierPhysicalArmorBonus()
return 10
end   
  function modifier_samurai_route_3:GetModifierPreAttack_BonusDamage()
return 150
end 
function modifier_samurai_route_3:OnAttackLanded(params)
	if IsServer() then
	self.chance = 55
	     if not self:GetParent():HasModifier("modifier_abyss_horn_cd") then
		if params.target~=self:GetCaster() then return end
		if params.attacker:GetTeamNumber()==params.target:GetTeamNumber() then return end
		if RandomInt(1,100)>self.chance then return end
		if not self:GetParent():IsStunned() then
			self:GetParent():PerformAttack(params.attacker, true,
				true,
				true,
				true,
				true,
				false,
				true)
		end
		self:GetParent():AddNewModifier(self:GetParent(), self, "modifier_abyss_horn_cd", {duration = 1.5})
		self:GetParent():EmitSound("halo.attack")
		
			end
		end
		end
	
	
	


	

function modifier_samurai_route_3:GetTexture()
	return "angel_halo"
end
function modifier_samurai_route_3:GetEffectName()
	return "particles/halo_stage_5_samurai_2.vpcf"
end
function modifier_samurai_route_3:StopAllMusic()
	local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
	if IsServer() then
		for i = 1, 30 do
			StopSoundOn("star.theme_"..i, Player)
		end
		  for i = 1, 6  do
			StopSoundOn("horn.hero_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("horn.demon_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("horn.samurai_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("spamton.theme_"..i, Player)
		end
		 for i = 1, 8  do
			StopSoundOn("new.year_theme_"..i, Player)
		end
	end

end










modifier_samurai_route_4 = class({})

function modifier_samurai_route_4:IsHidden()
	return false
end
function modifier_samurai_route_4:RemoveOnDeath() return true end
function modifier_samurai_route_4:AllowIllusionDuplicate()
	return true
end
function modifier_samurai_route_4:OnCreated()
self:StopAllMusic()
local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
EmitSoundOnClient("horn.samurai_4", Player) 

 end

 function modifier_samurai_route_4:OnDestroy()

local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
StopSoundOn("horn.samurai_4", Player)
 self.ability = self:GetAbility()
	self.ability:EndCooldown()
	 self.ability:StartCooldown(45)	
 end
function modifier_samurai_route_4:IsPurgable()
    return false
end

function modifier_samurai_route_4:DeclareFunctions()
    local funcs = {
        MODIFIER_PROPERTY_PREATTACK_BONUS_DAMAGE,
		MODIFIER_PROPERTY_PHYSICAL_ARMOR_BONUS,
		 MODIFIER_EVENT_ON_ATTACK_LANDED,

		
		
    }

    return funcs
end
  function modifier_samurai_route_4:GetModifierPhysicalArmorBonus()
return 20
end   
  function modifier_samurai_route_4:GetModifierPreAttack_BonusDamage()
return 220
end 
function modifier_samurai_route_4:OnAttackLanded(params)
	if IsServer() then
	self.chance = 70
	     if not self:GetParent():HasModifier("modifier_abyss_horn_cd") then
		if params.target~=self:GetCaster() then return end
		if params.attacker:GetTeamNumber()==params.target:GetTeamNumber() then return end
		if RandomInt(1,100)>self.chance then return end
		if not self:GetParent():IsStunned() then
			self:GetParent():PerformAttack(params.attacker, true,
				true,
				true,
				true,
				true,
				false,
				true)
		end
		self:GetParent():AddNewModifier(self:GetParent(), self, "modifier_abyss_horn_cd", {duration = 1.5})
		self:GetParent():EmitSound("halo.attack")
		
			end
		end
		end
	
	
	


	

function modifier_samurai_route_4:GetTexture()
	return "angel_halo"
end
function modifier_samurai_route_4:GetEffectName()
	return "particles/halo_stage_5_samurai_3.vpcf"
end
function modifier_samurai_route_4:StopAllMusic()
		local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
	if IsServer() then
			for i = 1, 30 do
			StopSoundOn("star.theme_"..i, Player)
		end
		  for i = 1, 6  do
			StopSoundOn("horn.hero_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("horn.demon_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("horn.samurai_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("spamton.theme_"..i, Player)
		end
		 for i = 1, 8  do
			StopSoundOn("new.year_theme_"..i, Player)
		end
	end
end




modifier_samurai_route_5 = class({})

function modifier_samurai_route_5:IsHidden()
	return false
end
function modifier_samurai_route_5:RemoveOnDeath() return true end
function modifier_samurai_route_5:AllowIllusionDuplicate()
	return true
end
function modifier_samurai_route_5:OnCreated()
self:StopAllMusic()
local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
EmitSoundOnClient("horn.samurai_5", Player) 
self:PlayEffects()
 end
 function modifier_samurai_route_5:StopAllMusic()
		local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
	if IsServer() then
			for i = 1, 30 do
			StopSoundOn("star.theme_"..i, Player)
		end
		  for i = 1, 6  do
			StopSoundOn("horn.hero_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("horn.demon_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("horn.samurai_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("spamton.theme_"..i, Player)
		end
		 for i = 1, 8  do
			StopSoundOn("new.year_theme_"..i, Player)
		end
	end
end

 function modifier_samurai_route_5:PlayEffects()
	-- get resources
	local particle_cast = "particles/samurai_flash.vpcf"
	

	-- play particle
	local effect_cast = ParticleManager:CreateParticle( particle_cast, PATTACH_ABSORIGIN, self:GetParent() )
	ParticleManager:SetParticleControl( effect_cast, 0, self:GetParent():GetOrigin() )
	ParticleManager:SetParticleControl( effect_cast, 1, Vector( self.reincarnate_time, 0, 0 ) )
	ParticleManager:ReleaseParticleIndex( effect_cast )

	-- play sound

end

 function modifier_samurai_route_5:OnDestroy()

local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
StopSoundOn("horn.samurai_5", Player) 
 self.ability = self:GetAbility()
	self.ability:EndCooldown()
	 self.ability:StartCooldown(60)	
 end
function modifier_samurai_route_5:IsPurgable()
    return false
end

function modifier_samurai_route_5:DeclareFunctions()
    local funcs = {
        MODIFIER_PROPERTY_PREATTACK_BONUS_DAMAGE,
		MODIFIER_PROPERTY_PHYSICAL_ARMOR_BONUS,
		 MODIFIER_EVENT_ON_ATTACK_LANDED,

		
		
    }

    return funcs
end
  function modifier_samurai_route_5:GetModifierPhysicalArmorBonus()
return 15
end   
  function modifier_samurai_route_5:GetModifierPreAttack_BonusDamage()
return 400
end 
function modifier_samurai_route_5:OnAttackLanded(params)
	if IsServer() then
	self.chance = 100
	     if not self:GetParent():HasModifier("modifier_abyss_horn_cd") then
		if params.target~=self:GetCaster() then return end
		if params.attacker:GetTeamNumber()==params.target:GetTeamNumber() then return end
		if RandomInt(1,100)>self.chance then return end
		if not self:GetParent():IsStunned() then
			self:GetParent():PerformAttack(params.attacker, true,
				true,
				true,
				true,
				true,
				false,
				true)
		end
		
		self:GetParent():AddNewModifier(self:GetParent(), self, "modifier_abyss_horn_cd", {duration = 1.5})
		self:GetParent():EmitSound("halo.attack")
		
			end
		end
		end
	
	
	


	

function modifier_samurai_route_5:GetTexture()
	return "angel_halo"
end
function modifier_samurai_route_5:GetEffectName()
	return "particles/samurai_5.vpcf"
end










modifier_samurai_route_6 = class({})

function modifier_samurai_route_6:IsHidden()
	return false
end
function modifier_samurai_route_6:RemoveOnDeath() return true end
function modifier_samurai_route_6:AllowIllusionDuplicate()
	return true
end
function modifier_samurai_route_6:OnCreated()
self:StopAllMusic()
local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
EmitSoundOnClient("horn.samurai_6", Player) 
self:PlayEffects()
 end
 


  function modifier_samurai_route_6:PlayEffects()
	-- get resources
	local particle_cast = "particles/samurai_flash2.vpcf"
	

	-- play particle
	local effect_cast = ParticleManager:CreateParticle( particle_cast, PATTACH_ABSORIGIN, self:GetParent() )
	ParticleManager:SetParticleControl( effect_cast, 0, self:GetParent():GetOrigin() )
	ParticleManager:SetParticleControl( effect_cast, 1, Vector( self.reincarnate_time, 0, 0 ) )
	ParticleManager:ReleaseParticleIndex( effect_cast )

	-- play sound

end

 function modifier_samurai_route_6:OnDestroy()

local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
StopSoundOn("horn.samurai_6", Player) 
 self.ability = self:GetAbility()
	self.ability:EndCooldown()
	 self.ability:StartCooldown(60)	
 end
function modifier_samurai_route_6:IsPurgable()
    return false
end

function modifier_samurai_route_6:DeclareFunctions()
    local funcs = {
        MODIFIER_PROPERTY_PREATTACK_BONUS_DAMAGE,
		MODIFIER_PROPERTY_PHYSICAL_ARMOR_BONUS,
		 MODIFIER_EVENT_ON_ATTACK_LANDED,

		
		
    }

    return funcs
end
  function modifier_samurai_route_6:GetModifierPhysicalArmorBonus()
return 15
end   
  function modifier_samurai_route_6:GetModifierPreAttack_BonusDamage()
return 300
end 
function modifier_samurai_route_6:OnAttackLanded(params)
	if IsServer() then
	self.chance = 100
	     if not self:GetParent():HasModifier("modifier_abyss_horn_cd") then
		if params.target~=self:GetCaster() then return end
		if params.attacker:GetTeamNumber()==params.target:GetTeamNumber() then return end
		if RandomInt(1,100)>self.chance then return end
		if not self:GetParent():IsStunned() then
			self:GetParent():PerformAttack(params.attacker, true,
				true,
				true,
				true,
				true,
				false,
				true)
		end
		self:GetParent():Heal(params.damage * 0.5, nil)
		self:GetParent():AddNewModifier(self:GetParent(), self, "modifier_abyss_horn_cd", {duration = 1.5})
		self:GetParent():EmitSound("halo.attack")
		
			end
		end
		end
	
	
	


	

function modifier_samurai_route_6:GetTexture()
	return "angel_halo"
end
function modifier_samurai_route_6:GetEffectName()
	return "particles/samurai_6.vpcf"
end
 function modifier_samurai_route_6:StopAllMusic()
		local Player = PlayerResource:GetPlayer(self:GetParent():GetPlayerID())
	if IsServer() then
			for i = 1, 30 do
			StopSoundOn("star.theme_"..i, Player)
		end
		  for i = 1, 6  do
			StopSoundOn("horn.hero_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("horn.demon_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("horn.samurai_"..i, Player)
		end
		 for i = 1, 6  do
			StopSoundOn("spamton.theme_"..i, Player)
		end
		 for i = 1, 8  do
			StopSoundOn("new.year_theme_"..i, Player)
		end
	end
end














------------------------
modifier_samurai_block = class({})

--------------------------------------------------------------------------------

function modifier_samurai_block:IsHidden()
	return false
end

function modifier_samurai_block:IsDebuff()
	return false
end

function modifier_samurai_block:IsPurgable()
	return false
end

function modifier_samurai_block:RemoveOnDeath()
	return false
end
function modifier_samurai_block:AllowIllusionDuplicate()
 return false 
 end
--------------------------------------------------------------------------------

function modifier_samurai_block:OnCreated( kv )
	self.block_passive = 70
	
	self.block_chance = 50
	
end

function modifier_samurai_block:OnRefresh( kv )
	-- get references
	self.block_passive = 70
  self.block_chance = 50
end

--------------------------------------------------------------------------------

function modifier_samurai_block:DeclareFunctions()
	local funcs = {

		MODIFIER_PROPERTY_PHYSICAL_CONSTANT_BLOCK,

	}

	return funcs
end
function modifier_samurai_block:GetModifierPhysical_ConstantBlock()

local rand = math.random(1, 100)

if rand <= self.block_chance then

	return self.block_passive
end

end



modifier_samurai_block2 = class({})

--------------------------------------------------------------------------------

function modifier_samurai_block2:IsHidden()
	return false
end

function modifier_samurai_block2:IsDebuff()
	return false
end

function modifier_samurai_block2:IsPurgable()
	return false
end

function modifier_samurai_block2:RemoveOnDeath()
	return false
end
function modifier_samurai_block2:AllowIllusionDuplicate()
 return false 
 end
--------------------------------------------------------------------------------

function modifier_samurai_block2:OnCreated( kv )
	self.block_passive = 70
	
	self.block_chance = 50
	
end

function modifier_samurai_block2:OnRefresh( kv )
	-- get references
	self.block_passive = 140
  self.block_chance = 50
end

--------------------------------------------------------------------------------

function modifier_samurai_block2:DeclareFunctions()
	local funcs = {

		MODIFIER_PROPERTY_PHYSICAL_CONSTANT_BLOCK,

	}

	return funcs
end
function modifier_samurai_block2:GetModifierPhysical_ConstantBlock()

local rand = math.random(1, 100)

if rand <= self.block_chance then

	return self.block_passive
end

end



modifier_samurai_full_counter = class({})

--------------------------------------------------------------------------------

function modifier_samurai_full_counter:IsHidden()
	return false
end

function modifier_samurai_full_counter:IsDebuff()
	return false
end

function modifier_samurai_full_counter:IsPurgable()
	return false
end

function modifier_samurai_full_counter:RemoveOnDeath()
	return false
end
function modifier_samurai_full_counter:AllowIllusionDuplicate()
 return false 
 end
--------------------------------------------------------------------------------

function modifier_samurai_full_counter:OnCreated( kv )
	self.block_passive = 1000
	
	self.block_chance = 100
	
end

function modifier_samurai_full_counter:OnRefresh( kv )
	-- get references
	self.block_passive = 1000
  self.block_chance = 1000
end

--------------------------------------------------------------------------------

function modifier_samurai_full_counter:DeclareFunctions()
	local funcs = {

		MODIFIER_PROPERTY_PHYSICAL_CONSTANT_BLOCK,

	}

	return funcs
end
function modifier_samurai_full_counter:GetModifierPhysical_ConstantBlock()

local rand = math.random(1, 100)

if rand <= self.block_chance then

	return self.block_passive
end

end




modifier_samurai_bleed = class({})

--------------------------------------------------------------------------------
-- Classifications
function modifier_samurai_bleed:IsHidden()
	return false
end

function modifier_samurai_bleed:IsDebuff()
	return true
end

function modifier_samurai_bleed:IsStunDebuff()
	return false
end

function modifier_samurai_bleed:IsPurgable()
	return true
end

--------------------------------------------------------------------------------
-- Initializations
function modifier_samurai_bleed:OnCreated( kv )
	-- references
	local tick_damage = 100 -- special value
	self.interval = 0.5

	if IsServer() then
		-- Apply Damage	 
		self.damageTable = {
			victim = self:GetParent(),
			attacker = self:GetCaster(),
			damage = tick_damage,
			damage_type = DAMAGE_TYPE_MAGICAL,
			ability = self, --Optional.
		}

		-- Start interval
		self:StartIntervalThink( self.interval )
		self:OnIntervalThink()

		-- Play Effects
		
	end
end

function modifier_samurai_bleed:OnRefresh( kv )
	-- references
	local tick_damage = 100 -- special value
	self.interval = 0.5

	if IsServer() then
		-- Apply Damage	 
		self.damageTable = {
			victim = self:GetParent(),
			attacker = self:GetCaster(),
			damage = tick_damage,
			damage_type = DAMAGE_TYPE_MAGICAL,
			damage_flags = DOTA_DAMAGE_FLAG_NONE, --Optional.
			ability = self, --Optional.
		}

		-- Start interval
		self:StartIntervalThink( self.interval )
		self:OnIntervalThink()

		-- Play Effects
		self.sound_target = ""
		EmitSoundOn( self.sound_target, self:GetParent() )
	end
end

function modifier_samurai_bleed:OnDestroy()
	StopSoundOn( self.sound_target, self:GetParent() )
end

--------------------------------------------------------------------------------
-- Status Effects
function modifier_samurai_bleed:CheckState()
	local state = {
	[MODIFIER_STATE_DISARMED] = true,
	[MODIFIER_STATE_INVISIBLE] = false,
	}

	return state
end

--------------------------------------------------------------------------------
-- Interval Effects
function modifier_samurai_bleed:OnIntervalThink()
	ApplyDamage( self.damageTable )
end

--------------------------------------------------------------------------------
-- Graphics & Animations
function modifier_samurai_bleed:GetEffectName()
	return "particles/units/heroes/hero_bloodseeker/bloodseeker_rupture.vpcf"
end

function modifier_samurai_bleed:GetEffectAttachType()
	return PATTACH_ABSORIGIN_FOLLOW
end